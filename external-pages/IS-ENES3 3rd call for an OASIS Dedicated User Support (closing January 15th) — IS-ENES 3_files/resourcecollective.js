
/* Merged Plone Javascript file
 * This file is dynamically assembled from separate parts.
 * Some of these parts have 3rd party licenses or copyright information attached
 * Such information is valid for that section,
 * not for the entire composite file
 * originating files are separated by - filename.js -
 */

/* - ++resource++collective.js.moment/moment.js - */
// https://is.enes.org/portal_javascripts/++resource++collective.js.moment/moment.js?original=1
(function(Date,undefined){var moment,VERSION="1.7.0",round=Math.round,i,languages={},currentLanguage='en',hasModule=(typeof module!=='undefined'&&module.exports),langConfigProperties='months|monthsShort|weekdays|weekdaysShort|weekdaysMin|longDateFormat|calendar|relativeTime|ordinal|meridiem'.split('|'),aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?)/g,localFormattingTokens=/(LT|LL?L?L?)/g,formattingRemoveEscapes=/(^\[)|(\\)|\]$/g,parseMultipleFormatChunker=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{1,4}/,parseTokenWord=/[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/i,parseTokenT=/T/i,isoRegex=/^\s*\d{4}-\d\d-\d\d(T(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,isoFormat='YYYY-MM-DDTHH:mm:ssZ',isoTimes=[['HH:mm:ss.S',/T\d\d:\d\d:\d\d\.\d{1,3}/],['HH:mm:ss',/T\d\d:\d\d:\d\d/],['HH:mm',/T\d\d:\d\d/],['HH',/T\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters='Month|Date|Hours|Minutes|Seconds|Milliseconds'.split('|'),unitMillisecondFactors={'Milliseconds':1,'Seconds':1e3,'Minutes':6e4,'Hours':36e5,'Days':864e5,'Months':2592e6,'Years':31536e6},formatFunctions={},formatFunctionStrings={M:'(a=t.month()+1)',MMM:'v("monthsShort",t.month())',MMMM:'v("months",t.month())',D:'(a=t.date())',DDD:'(a=new Date(t.year(),t.month(),t.date()),b=new Date(t.year(),0,1),a=~~(((a-b)/864e5)+1.5))',d:'(a=t.day())',dd:'v("weekdaysMin",t.day())',ddd:'v("weekdaysShort",t.day())',dddd:'v("weekdays",t.day())',w:'(a=new Date(t.year(),t.month(),t.date()-t.day()+5),b=new Date(a.getFullYear(),0,4),a=~~((a-b)/864e5/7+1.5))',YY:'p(t.year()%100,2)',YYYY:'p(t.year(),4)',a:'m(t.hours(),t.minutes(),!0)',A:'m(t.hours(),t.minutes(),!1)',H:'t.hours()',h:'t.hours()%12||12',m:'t.minutes()',s:'t.seconds()',S:'~~(t.milliseconds()/100)',SS:'p(~~(t.milliseconds()/10),2)',SSS:'p(t.milliseconds(),3)',Z:'((a=-t.zone())<0?((a=-a),"-"):"+")+p(~~(a/60),2)+":"+p(~~a%60,2)',ZZ:'((a=-t.zone())<0?((a=-a),"-"):"+")+p(~~(10*a/6),4)'},ordinalizeTokens='DDD w M D d'.split(' '),paddedTokens='M D H h m s w'.split(' ');while(ordinalizeTokens.length){i=ordinalizeTokens.pop();formatFunctionStrings[i+'o']=formatFunctionStrings[i]+'+o(a)'}
while(paddedTokens.length){i=paddedTokens.pop();formatFunctionStrings[i+i]='p('+formatFunctionStrings[i]+',2)'}
formatFunctionStrings.DDDD='p('+formatFunctionStrings.DDD+',3)';
function Moment(date,isUTC,lang){this._d=date;this._isUTC=!!isUTC;this._a=date._a||null;date._a=null;this._lang=lang||false}
function Duration(duration){var data=this._data={},years=duration.years||duration.y||0,months=duration.months||duration.M||0,weeks=duration.weeks||duration.w||0,days=duration.days||duration.d||0,hours=duration.hours||duration.h||0,minutes=duration.minutes||duration.m||0,seconds=duration.seconds||duration.s||0,milliseconds=duration.milliseconds||duration.ms||0;this._milliseconds=milliseconds+seconds * 1e3+minutes * 6e4+hours * 36e5;this._days=days+weeks * 7;this._months=months+years * 12;data.milliseconds=milliseconds%1000;seconds+=absRound(milliseconds/1000);data.seconds=seconds%60;minutes+=absRound(seconds/60);data.minutes=minutes%60;hours+=absRound(minutes/60);data.hours=hours%24;days+=absRound(hours/24);days+=weeks * 7;data.days=days%30;months+=absRound(days/30);data.months=months%12;years+=absRound(months/12);data.years=years;this._lang=false}
function absRound(number){if(number<0){return Math.ceil(number)} else{return Math.floor(number)}}
function leftZeroFill(number,targetLength){var output=number+'';while(output.length<targetLength){output='0'+output}
return output}
function addOrSubtractDurationFromMoment(mom,duration,isAdding){var ms=duration._milliseconds,d=duration._days,M=duration._months,currentDate;if(ms){mom._d.setTime(+mom+ms * isAdding)}
if(d){mom.date(mom.date()+d * isAdding)}
if(M){currentDate=mom.date();mom.date(1).month(mom.month()+M * isAdding).date(Math.min(currentDate,mom.daysInMonth()))}}
function isArray(input){return Object.prototype.toString.call(input)==='[object Array]'}
function compareArrays(array1,array2){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(~~array1[i]!==~~array2[i]){diffs++}}
return diffs+lengthDiff}
function dateFromArray(input,asUTC){var i,date;for(i=1;i<7;i++){input[i]=(input[i]==null)?(i===2?1:0):input[i]}
input[7]=asUTC;date=new Date(0);if(asUTC){date.setUTCFullYear(input[0],input[1],input[2]);date.setUTCHours(input[3],input[4],input[5],input[6])} else{date.setFullYear(input[0],input[1],input[2]);date.setHours(input[3],input[4],input[5],input[6])}
date._a=input;return date}
function loadLang(key,values){var i,m,parse=[];if(!values&&hasModule){values=require('./lang/'+key)}
if(!values){values=require('./lang/'+key)}
for(i=0;i<langConfigProperties.length;i++){values[langConfigProperties[i]]=values[langConfigProperties[i]]||languages.en[langConfigProperties[i]]}
for(i=0;i<12;i++){m=moment([2000,i]);parse[i]=new RegExp('^'+(values.months[i]||values.months(m,''))+'|^'+(values.monthsShort[i]||values.monthsShort(m,'')).replace('.',''),'i')}
values.monthsParse=values.monthsParse||parse;languages[key]=values;return values}
function getLangDefinition(m){var langKey=(typeof m==='string')&&m||m&&m._lang||null;return langKey?(languages[langKey]||loadLang(langKey)):moment}
function replaceFormatTokens(token){return formatFunctionStrings[token]?("'+("+formatFunctionStrings[token]+")+'"):token.replace(formattingRemoveEscapes,"").replace(/\\?'/g, "\\'")}
function replaceLongDateFormatTokens(input){return getLangDefinition().longDateFormat[input]||input}
function makeFormatFunction(format){var output="var a,b;return '"+format.replace(formattingTokens,replaceFormatTokens)+"';",Fn=Function;return new Fn('t','v','o','p','m',output)}
function makeOrGetFormatFunction(format){if(!formatFunctions[format]){formatFunctions[format]=makeFormatFunction(format)}
return formatFunctions[format]}
function formatMoment(m,format){var lang=getLangDefinition(m);
function getValueFromArray(key,index){return lang[key].call?lang[key](m,format):lang[key][index]}
while(localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens)}
if(!formatFunctions[format]){formatFunctions[format]=makeFormatFunction(format)}
return formatFunctions[format](m,getValueFromArray,lang.ordinal,leftZeroFill,lang.meridiem)}
function getParseRegexForToken(token){switch(token){case 'DDDD':return parseTokenThreeDigits;case 'YYYY':return parseTokenFourDigits;case 'S':case 'SS':case 'SSS':case 'DDD':return parseTokenOneToThreeDigits;case 'MMM':case 'MMMM':case 'dd':case 'ddd':case 'dddd':case 'a':case 'A':return parseTokenWord;case 'Z':case 'ZZ':return parseTokenTimezone;case 'T':return parseTokenT;case 'MM':case 'DD':case 'YY':case 'HH':case 'hh':case 'mm':case 'ss':case 'M':case 'D':case 'd':case 'H':case 'h':case 'm':case 's':return parseTokenOneOrTwoDigits;default:return new RegExp(token.replace('\\',''))}}
function addTimeToArrayFromToken(token,input,datePartArray,config){var a;switch(token){case 'M':case 'MM':datePartArray[1]=(input==null)?0:~~input-1;break;case 'MMM':case 'MMMM':for(a=0;a<12;a++){if(getLangDefinition().monthsParse[a].test(input)){datePartArray[1]=a;break}}
break;case 'D':case 'DD':case 'DDD':case 'DDDD':if(input!=null){datePartArray[2]=~~input}
break;case 'YY':input=~~input;datePartArray[0]=input+(input>70?1900:2000);break;case 'YYYY':datePartArray[0]=~~Math.abs(input);break;case 'a':case 'A':config.isPm=((input+'').toLowerCase()==='pm');break;case 'H':case 'HH':case 'h':case 'hh':datePartArray[3]=~~input;break;case 'm':case 'mm':datePartArray[4]=~~input;break;case 's':case 'ss':datePartArray[5]=~~input;break;case 'S':case 'SS':case 'SSS':datePartArray[6]=~~(('0.'+input) * 1000);break;case 'Z':case 'ZZ':config.isUTC=true;a=(input+'').match(parseTimezoneChunker);if(a&&a[1]){config.tzh=~~a[1]}
if(a&&a[2]){config.tzm=~~a[2]}
if(a&&a[0]==='+'){config.tzh=-config.tzh;config.tzm=-config.tzm}
break}}
function makeDateFromStringAndFormat(string,format){var datePartArray=[0,0,1,0,0,0,0],config={tzh:0,tzm:0},tokens=format.match(formattingTokens),i,parsedInput;for(i=0;i<tokens.length;i++){parsedInput=(getParseRegexForToken(tokens[i]).exec(string)||[])[0];string=string.replace(getParseRegexForToken(tokens[i]),'');addTimeToArrayFromToken(tokens[i],parsedInput,datePartArray,config)}
if(config.isPm&&datePartArray[3]<12){datePartArray[3]+=12}
if(config.isPm===false&&datePartArray[3]===12){datePartArray[3]=0}
datePartArray[3]+=config.tzh;datePartArray[4]+=config.tzm;return dateFromArray(datePartArray,config.isUTC)}
function makeDateFromStringAndArray(string,formats){var output,inputParts=string.match(parseMultipleFormatChunker)||[],formattedInputParts,scoreToBeat=99,i,currentDate,currentScore;for(i=0;i<formats.length;i++){currentDate=makeDateFromStringAndFormat(string,formats[i]);formattedInputParts=formatMoment(new Moment(currentDate),formats[i]).match(parseMultipleFormatChunker)||[];currentScore=compareArrays(inputParts,formattedInputParts);if(currentScore<scoreToBeat){scoreToBeat=currentScore;output=currentDate}}
return output}
function makeDateFromString(string){var format='YYYY-MM-DDT',i;if(isoRegex.exec(string)){for(i=0;i<4;i++){if(isoTimes[i][1].exec(string)){format+=isoTimes[i][0];break}}
return parseTokenTimezone.exec(string)?makeDateFromStringAndFormat(string,format+' Z'):makeDateFromStringAndFormat(string,format)}
return new Date(string)}
function substituteTimeAgo(string,number,withoutSuffix,isFuture,lang){var rt=lang.relativeTime[string];return(typeof rt==='function')?rt(number||1,!!withoutSuffix,string,isFuture):rt.replace(/%d/i,number||1)}
function relativeTime(milliseconds,withoutSuffix,lang){var seconds=round(Math.abs(milliseconds)/1000),minutes=round(seconds/60),hours=round(minutes/60),days=round(hours/24),years=round(days/365),args=seconds<45&&['s',seconds]||minutes===1&&['m']||minutes<45&&['mm',minutes]||hours===1&&['h']||hours<22&&['hh',hours]||days===1&&['d']||days<=25&&['dd',days]||days<=45&&['M']||days<345&&['MM',round(days/30)]||years===1&&['y']||['yy',years];args[2]=withoutSuffix;args[3]=milliseconds>0;args[4]=lang;return substituteTimeAgo.apply({},args)}
moment=function(input,format){if(input===null||input===''){return null}
var date,matched;if(moment.isMoment(input)){return new Moment(new Date(+input._d),input._isUTC,input._lang)} else if(format){if(isArray(format)){date=makeDateFromStringAndArray(input,format)} else{date=makeDateFromStringAndFormat(input,format)}} else{matched=aspNetJsonRegex.exec(input);date=input===undefined?new Date():matched?new Date(+matched[1]):input instanceof Date?input:isArray(input)?dateFromArray(input):typeof input==='string'?makeDateFromString(input):new Date(input)}
return new Moment(date)};moment.utc=function(input,format){if(isArray(input)){return new Moment(dateFromArray(input,true),true)}
if(typeof input==='string'&&!parseTokenTimezone.exec(input)){input+=' +0000';if(format){format+=' Z'}}
return moment(input,format).utc()};moment.unix=function(input){return moment(input * 1000)};moment.duration=function(input,key){var isDuration=moment.isDuration(input),isNumber=(typeof input==='number'),duration=(isDuration?input._data:(isNumber?{}:input)),ret;if(isNumber){if(key){duration[key]=input} else{duration.milliseconds=input}}
ret=new Duration(duration);if(isDuration){ret._lang=input._lang}
return ret};moment.humanizeDuration=function(num,type,withSuffix){return moment.duration(num,type===true?null:type).humanize(type===true?true:withSuffix)};moment.version=VERSION;moment.defaultFormat=isoFormat;moment.lang=function(key,values){var i;if(!key){return currentLanguage}
if(values||!languages[key]){loadLang(key,values)}
if(languages[key]){for(i=0;i<langConfigProperties.length;i++){moment[langConfigProperties[i]]=languages[key][langConfigProperties[i]]}
moment.monthsParse=languages[key].monthsParse;currentLanguage=key}};moment.langData=getLangDefinition;moment.isMoment=function(obj){return obj instanceof Moment};moment.isDuration=function(obj){return obj instanceof Duration};moment.lang('en',{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem: function(hours,minutes,isLower){if(hours>11){return isLower?'pm':'PM'} else{return isLower?'am':'AM'}},calendar:{sameDay:'[Today at] LT',nextDay:'[Tomorrow at] LT',nextWeek:'dddd [at] LT',lastDay:'[Yesterday at] LT',lastWeek:'[last] dddd [at] LT',sameElse:'L'},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal: function(number){var b=number%10;return(~~(number%100/10)===1)?'th':(b===1)?'st':(b===2)?'nd':(b===3)?'rd':'th'}});moment.fn=Moment.prototype={clone: function(){return moment(this)},valueOf: function(){return+this._d},unix: function(){return Math.floor(+this._d/1000)},toString: function(){return this._d.toString()},toDate: function(){return this._d},toArray: function(){var m=this;return [m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds(),!!this._isUTC]},isValid: function(){if(this._a){return!compareArrays(this._a,(this._a[7]?moment.utc(this):this).toArray())}
return!isNaN(this._d.getTime())},utc: function(){this._isUTC=true;return this},local: function(){this._isUTC=false;return this},format: function(inputString){return formatMoment(this,inputString?inputString:moment.defaultFormat)},add: function(input,val){var dur=val?moment.duration(+val,input):moment.duration(input);addOrSubtractDurationFromMoment(this,dur,1);return this},subtract: function(input,val){var dur=val?moment.duration(+val,input):moment.duration(input);addOrSubtractDurationFromMoment(this,dur,-1);return this},diff: function(input,val,asFloat){var inputMoment=this._isUTC?moment(input).utc():moment(input).local(),zoneDiff=(this.zone()-inputMoment.zone()) * 6e4,diff=this._d-inputMoment._d-zoneDiff,year=this.year()-inputMoment.year(),month=this.month()-inputMoment.month(),date=this.date()-inputMoment.date(),output;if(val==='months'){output=year * 12+month+date/30} else if(val==='years'){output=year+(month+date/ 30) / 12} else{output=val==='seconds'?diff/ 1e3 : //1000
val==='minutes'?diff/ 6e4 : //1000 * 60
val==='hours'?diff/ 36e5 : //1000 * 60 * 60
val==='days'?diff/ 864e5 : //1000 * 60 * 60 * 24
val==='weeks'?diff/ 6048e5 : //1000 * 60 * 60 * 24 * 7
diff}
return asFloat?output:round(output)},from: function(time,withoutSuffix){return moment.duration(this.diff(time)).lang(this._lang).humanize(!withoutSuffix)},fromNow: function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar: function(){var diff=this.diff(moment().sod(),'days',true),calendar=this.lang().calendar,allElse=calendar.sameElse,format=diff<-6?allElse:diff<-1?calendar.lastWeek:diff<0?calendar.lastDay:diff<1?calendar.sameDay:diff<2?calendar.nextDay:diff<7?calendar.nextWeek:allElse;return this.format(typeof format==='function'?format.apply(this):format)},isLeapYear: function(){var year=this.year();return(year%4===0&&year%100!==0)||year%400===0},isDST: function(){return(this.zone()<moment([this.year()]).zone()||this.zone()<moment([this.year(),5]).zone())},day: function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return input==null?day:this.add({d:input-day})},startOf: function(val){switch(val.replace(/s$/,'')){case 'year':this.month(0);case 'month':this.date(1);case 'day':this.hours(0);case 'hour':this.minutes(0);case 'minute':this.seconds(0);case 'second':this.milliseconds(0)}
return this},endOf: function(val){return this.startOf(val).add(val.replace(/s?$/,'s'),1).subtract('ms',1)},sod: function(){return this.clone().startOf('day')},eod: function(){return this.clone().endOf('day')},zone: function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth: function(){return moment.utc([this.year(),this.month()+1,0]).date()},lang: function(lang){if(lang===undefined){return getLangDefinition(this)} else{this._lang=lang;return this}}};
function makeGetterAndSetter(name,key){moment.fn[name]=function(input){var utc=this._isUTC?'UTC':'';if(input!=null){this._d['set'+utc+key](input);return this} else{return this._d['get'+utc+key]()}}}
for(i=0;i<proxyGettersAndSetters.length;i++){makeGetterAndSetter(proxyGettersAndSetters[i].toLowerCase(),proxyGettersAndSetters[i])}
makeGetterAndSetter('year','FullYear');moment.duration.fn=Duration.prototype={weeks: function(){return absRound(this.days()/7)},valueOf: function(){return this._milliseconds+this._days * 864e5+this._months * 2592e6},humanize: function(withSuffix){var difference=+this,rel=this.lang().relativeTime,output=relativeTime(difference,!withSuffix,this.lang());if(withSuffix){output=(difference<=0?rel.past:rel.future).replace(/%s/i,output)}
return output},lang:moment.fn.lang};
function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}
function makeDurationAsGetter(name,factor){moment.duration.fn['as'+name]=function(){return+this/factor}}
for(i in unitMillisecondFactors){if(unitMillisecondFactors.hasOwnProperty(i)){makeDurationAsGetter(i,unitMillisecondFactors[i]);makeDurationGetter(i.toLowerCase())}}
makeDurationAsGetter('Weeks',6048e5);if(hasModule){module.exports=moment}
if(typeof ender==='undefined'){this['moment']=moment}
if(typeof define==="function"&&define.amd){define("moment",[], function(){return moment})}}).call(this,Date);

/* - ++resource++jquery.prettyPhoto.js - */
// https://is.enes.org/portal_javascripts/++resource++jquery.prettyPhoto.js?original=1
(function($){$.prettyPhoto={version:'3.1.5'};$.fn.prettyPhoto=function(pp_settings){pp_settings=jQuery.extend({hook:'rel',animation_speed:'fast',ajaxcallback: function(){},slideshow:5000,autoplay_slideshow:false,opacity:0.80,show_title:true,allow_resize:true,allow_expand:true,default_width:500,default_height:344,counter_separator_label:'/',theme:'pp_default',horizontal_padding:20,hideflash:false,wmode:'opaque',autoplay:true,modal:false,deeplinking:true,overlay_gallery:true,overlay_gallery_max:30,keyboard_shortcuts:true,changepicturecallback: function(){},callback: function(){},ie6_fallback:true,markup:'<div class="pp_pic_holder">\<div class="ppt">&nbsp;</div>\<div class="pp_top">\<div class="pp_left"></div>\<div class="pp_middle"></div>\<div class="pp_right"></div>\</div>\<div class="pp_content_container">\<div class="pp_left">\<div class="pp_right">\<div class="pp_content">\<div class="pp_loaderIcon"></div>\<div class="pp_fade">\<a href="#" class="pp_expand" title="Expand the image">Expand</a>\<div class="pp_hoverContainer">\<a class="pp_next" href="#">next</a>\<a class="pp_previous" href="#">previous</a>\</div>\<div id="pp_full_res"></div>\<div class="pp_details">\<div class="pp_nav">\<a href="#" class="pp_arrow_previous">Previous</a>\<p class="currentTextHolder">0/0</p>\<a href="#" class="pp_arrow_next">Next</a>\</div>\<p class="pp_description"></p>\<div class="pp_social">{pp_social}</div>\<a class="pp_close" href="#">Close</a>\</div>\</div>\</div>\</div>\</div>\</div>\<div class="pp_bottom">\<div class="pp_left"></div>\<div class="pp_middle"></div>\<div class="pp_right"></div>\</div>\</div>\<div class="pp_overlay"></div>',gallery_markup:'<div class="pp_gallery">\<a href="#" class="pp_arrow_previous">Previous</a>\<div>\<ul>\{gallery} \</ul>\</div>\<a href="#" class="pp_arrow_next">Next</a>\</div>',image_markup:'<img id="fullResImage" src="{path}" />',flash_markup:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="{width}" height="{height}"><param name="wmode" value="{wmode}" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{path}" /><embed src="{path}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="{width}" height="{height}" wmode="{wmode}"></embed></object>',quicktime_markup:'<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" height="{height}" width="{width}"><param name="src" value="{path}"><param name="autoplay" value="{autoplay}"><param name="type" value="video/quicktime"><embed src="{path}" height="{height}" width="{width}" autoplay="{autoplay}" type="video/quicktime" pluginspage="http://www.apple.com/quicktime/download/"></embed></object>',iframe_markup:'<iframe src ="{path}" width="{width}" height="{height}" frameborder="no"></iframe>',inline_markup:'<div class="pp_inline">{content}</div>',custom_markup:'',social_tools:'<div class="twitter"><a href="http://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script></div><div class="facebook"><iframe src="//www.facebook.com/plugins/like.php?locale=en_US&href={location_href}&amp;layout=button_count&amp;show_faces=true&amp;width=500&amp;action=like&amp;font&amp;colorscheme=light&amp;height=23" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:500px; height:23px;" allowTransparency="true"></iframe></div>'},pp_settings);var matchedObjects=this,percentBased=false,pp_dimensions,pp_open,pp_contentHeight,pp_contentWidth,pp_containerHeight,pp_containerWidth,windowHeight=$(window).height(),windowWidth=$(window).width(),pp_slideshow;doresize=true,scroll_pos=_get_scroll();$(window).unbind('resize.prettyphoto').bind('resize.prettyphoto',function(){_center_overlay();_resize_overlay()});if(pp_settings.keyboard_shortcuts){$(document).unbind('keydown.prettyphoto').bind('keydown.prettyphoto',function(e){if(typeof $pp_pic_holder!='undefined'){if($pp_pic_holder.is(':visible')){switch(e.keyCode){case 37:$.prettyPhoto.changePage('previous');e.preventDefault();break;case 39:$.prettyPhoto.changePage('next');e.preventDefault();break;case 27:if(!settings.modal)
$.prettyPhoto.close();e.preventDefault();break}}}})};$.prettyPhoto.initialize=function(){settings=pp_settings;if(settings.theme=='pp_default') settings.horizontal_padding=16;theRel=$(this).attr(settings.hook);galleryRegExp=/\[(?:.*)\]/;isSet=(galleryRegExp.exec(theRel))?true:false;pp_images=(isSet)?jQuery.map(matchedObjects, function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1) return $(n).attr('href')}):$.makeArray($(this).attr('href'));pp_titles=(isSet)?jQuery.map(matchedObjects, function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1) return($(n).find('img').attr('alt'))?$(n).find('img').attr('alt'):""}):$.makeArray($(this).find('img').attr('alt'));pp_descriptions=(isSet)?jQuery.map(matchedObjects, function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1) return($(n).attr('title'))?$(n).attr('title'):""}):$.makeArray($(this).attr('title'));if(pp_images.length>settings.overlay_gallery_max) settings.overlay_gallery=false;set_position=jQuery.inArray($(this).attr('href'),pp_images);rel_index=(isSet)?set_position:$("a["+settings.hook+"^='"+theRel+"']").index($(this));_build_overlay(this);if(settings.allow_resize)
$(window).bind('scroll.prettyphoto',function(){_center_overlay()});$.prettyPhoto.open();return false}
$.prettyPhoto.open=function(event){if(typeof settings=="undefined"){settings=pp_settings;pp_images=$.makeArray(arguments[0]);pp_titles=(arguments[1])?$.makeArray(arguments[1]):$.makeArray("");pp_descriptions=(arguments[2])?$.makeArray(arguments[2]):$.makeArray("");isSet=(pp_images.length>1)?true:false;set_position=(arguments[3])?arguments[3]:0;_build_overlay(event.target)}
if(settings.hideflash) $('object,embed,iframe[src*=youtube],iframe[src*=vimeo]').css('visibility','hidden');_checkPosition($(pp_images).size());$('.pp_loaderIcon').show();if(settings.deeplinking)
setHashtag();if(settings.social_tools){facebook_like_link=settings.social_tools.replace('{location_href}',encodeURIComponent(location.href));$pp_pic_holder.find('.pp_social').html(facebook_like_link)}
if($ppt.is(':hidden')) $ppt.css('opacity',0).show();$pp_overlay.show().fadeTo(settings.animation_speed,settings.opacity);$pp_pic_holder.find('.currentTextHolder').text((set_position+1)+settings.counter_separator_label+$(pp_images).size());if(typeof pp_descriptions[set_position]!='undefined'&&pp_descriptions[set_position]!=""){$pp_pic_holder.find('.pp_description').show().html(unescape(pp_descriptions[set_position]))}else{$pp_pic_holder.find('.pp_description').hide()}
movie_width=(parseFloat(getParam('width',pp_images[set_position])))?getParam('width',pp_images[set_position]):settings.default_width.toString();movie_height=(parseFloat(getParam('height',pp_images[set_position])))?getParam('height',pp_images[set_position]):settings.default_height.toString();percentBased=false;if(movie_height.indexOf('%')!=-1){movie_height=parseFloat(($(window).height() * parseFloat(movie_height)/100)-150);percentBased=true}
if(movie_width.indexOf('%')!=-1){movie_width=parseFloat(($(window).width() * parseFloat(movie_width)/100)-150);percentBased=true}
$pp_pic_holder.fadeIn(function(){(settings.show_title&&pp_titles[set_position]!=""&&typeof pp_titles[set_position]!="undefined")?$ppt.html(unescape(pp_titles[set_position])):$ppt.html('&nbsp;');imgPreloader="";skipInjection=false;switch(_getFileType(pp_images[set_position])){case 'image':imgPreloader=new Image();nextImage=new Image();if(isSet&&set_position<$(pp_images).size()-1) nextImage.src=pp_images[set_position+1];prevImage=new Image();if(isSet&&pp_images[set_position-1]) prevImage.src=pp_images[set_position-1];$pp_pic_holder.find('#pp_full_res')[0].innerHTML=settings.image_markup.replace(/{path}/g,pp_images[set_position]);imgPreloader.onload=function(){pp_dimensions=_fitToViewport(imgPreloader.width,imgPreloader.height);_showContent()};imgPreloader.onerror=function(){alert('Image cannot be loaded. Make sure the path is correct and image exist.');$.prettyPhoto.close()};imgPreloader.src=pp_images[set_position];break;case 'youtube':pp_dimensions=_fitToViewport(movie_width,movie_height);movie_id=getParam('v',pp_images[set_position]);if(movie_id==""){movie_id=pp_images[set_position].split('youtu.be/');movie_id=movie_id[1];if(movie_id.indexOf('?')>0)
movie_id=movie_id.substr(0,movie_id.indexOf('?'));if(movie_id.indexOf('&')>0)
movie_id=movie_id.substr(0,movie_id.indexOf('&'))}
movie='http://www.youtube.com/embed/'+movie_id;(getParam('rel',pp_images[set_position]))?movie+="?rel="+getParam('rel',pp_images[set_position]):movie+="?rel=1";if(settings.autoplay) movie+="&autoplay=1";toInject=settings.iframe_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,movie);break;case 'vimeo':pp_dimensions=_fitToViewport(movie_width,movie_height);movie_id=pp_images[set_position];var regExp=/http(s?):\/\/(www\.)?vimeo.com\/(\d+)/;var match=movie_id.match(regExp);movie='http://player.vimeo.com/video/'+match[3]+'?title=0&amp;byline=0&amp;portrait=0';if(settings.autoplay) movie+="&autoplay=1;";vimeo_width=pp_dimensions['width']+'/embed/?moog_width='+pp_dimensions['width'];toInject=settings.iframe_markup.replace(/{width}/g,vimeo_width).replace(/{height}/g,pp_dimensions['height']).replace(/{path}/g,movie);break;case 'quicktime':pp_dimensions=_fitToViewport(movie_width,movie_height);pp_dimensions['height']+=15;pp_dimensions['contentHeight']+=15;pp_dimensions['containerHeight']+=15;toInject=settings.quicktime_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,pp_images[set_position]).replace(/{autoplay}/g,settings.autoplay);break;case 'flash':pp_dimensions=_fitToViewport(movie_width,movie_height);flash_vars=pp_images[set_position];flash_vars=flash_vars.substring(pp_images[set_position].indexOf('flashvars')+10,pp_images[set_position].length);filename=pp_images[set_position];filename=filename.substring(0,filename.indexOf('?'));toInject=settings.flash_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,filename+'?'+flash_vars);break;case 'iframe':pp_dimensions=_fitToViewport(movie_width,movie_height);frame_url=pp_images[set_position];frame_url=frame_url.substr(0,frame_url.indexOf('iframe')-1);toInject=settings.iframe_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{path}/g,frame_url);break;case 'ajax':doresize=false;pp_dimensions=_fitToViewport(movie_width,movie_height);doresize=true;skipInjection=true;$.get(pp_images[set_position],function(responseHTML){toInject=settings.inline_markup.replace(/{content}/g,responseHTML);$pp_pic_holder.find('#pp_full_res')[0].innerHTML=toInject;_showContent()});break;case 'custom':pp_dimensions=_fitToViewport(movie_width,movie_height);toInject=settings.custom_markup;break;case 'inline':myClone=$(pp_images[set_position]).clone().append('<br clear="all" />').css({'width':settings.default_width}).wrapInner('<div id="pp_full_res"><div class="pp_inline"></div></div>').appendTo($('body')).show();doresize=false;pp_dimensions=_fitToViewport($(myClone).width(),$(myClone).height());doresize=true;$(myClone).remove();toInject=settings.inline_markup.replace(/{content}/g,$(pp_images[set_position]).html());break};if(!imgPreloader&&!skipInjection){$pp_pic_holder.find('#pp_full_res')[0].innerHTML=toInject;_showContent()}});return false};$.prettyPhoto.changePage=function(direction){currentGalleryPage=0;if(direction=='previous'){set_position--;if(set_position<0) set_position=$(pp_images).size()-1}else if(direction=='next'){set_position++;if(set_position>$(pp_images).size()-1) set_position=0}else{set_position=direction};rel_index=set_position;if(!doresize) doresize=true;if(settings.allow_expand){$('.pp_contract').removeClass('pp_contract').addClass('pp_expand')}
_hideContent(function(){$.prettyPhoto.open()})};$.prettyPhoto.changeGalleryPage=function(direction){if(direction=='next'){currentGalleryPage++;if(currentGalleryPage>totalPage) currentGalleryPage=0}else if(direction=='previous'){currentGalleryPage--;if(currentGalleryPage<0) currentGalleryPage=totalPage}else{currentGalleryPage=direction};slide_speed=(direction=='next'||direction=='previous')?settings.animation_speed:0;slide_to=currentGalleryPage *(itemsPerPage * itemWidth);$pp_gallery.find('ul').animate({left:-slide_to},slide_speed)};$.prettyPhoto.startSlideshow=function(){if(typeof pp_slideshow=='undefined'){$pp_pic_holder.find('.pp_play').unbind('click').removeClass('pp_play').addClass('pp_pause').click(function(){$.prettyPhoto.stopSlideshow();return false});pp_slideshow=setInterval($.prettyPhoto.startSlideshow,settings.slideshow)}else{$.prettyPhoto.changePage('next')}}
$.prettyPhoto.stopSlideshow=function(){$pp_pic_holder.find('.pp_pause').unbind('click').removeClass('pp_pause').addClass('pp_play').click(function(){$.prettyPhoto.startSlideshow();return false});clearInterval(pp_slideshow);pp_slideshow=undefined}
$.prettyPhoto.close=function(){if($pp_overlay.is(":animated")) return;$.prettyPhoto.stopSlideshow();$pp_pic_holder.stop().find('object,embed').css('visibility','hidden');$('div.pp_pic_holder,div.ppt,.pp_fade').fadeOut(settings.animation_speed,function(){$(this).remove()});$pp_overlay.fadeOut(settings.animation_speed, function(){if(settings.hideflash) $('object,embed,iframe[src*=youtube],iframe[src*=vimeo]').css('visibility','visible');$(this).remove();$(window).unbind('scroll.prettyphoto');clearHashtag();settings.callback();doresize=true;pp_open=false;delete settings})};
function _showContent(){$('.pp_loaderIcon').hide();projectedTop=scroll_pos['scrollTop']+((windowHeight/2)-(pp_dimensions['containerHeight']/2));if(projectedTop<0) projectedTop=0;$ppt.fadeTo(settings.animation_speed,1);$pp_pic_holder.find('.pp_content').animate({height:pp_dimensions['contentHeight'],width:pp_dimensions['contentWidth']},settings.animation_speed);$pp_pic_holder.animate({'top':projectedTop,'left':((windowWidth/2)-(pp_dimensions['containerWidth']/2) < 0) ? 0 : (windowWidth/2) - (pp_dimensions['containerWidth']/2),width:pp_dimensions['containerWidth']},settings.animation_speed,function(){$pp_pic_holder.find('.pp_hoverContainer,#fullResImage').height(pp_dimensions['height']).width(pp_dimensions['width']);$pp_pic_holder.find('.pp_fade').fadeIn(settings.animation_speed);if(isSet&&_getFileType(pp_images[set_position])=="image"){$pp_pic_holder.find('.pp_hoverContainer').show()}else{$pp_pic_holder.find('.pp_hoverContainer').hide()}
if(settings.allow_expand){if(pp_dimensions['resized']){$('a.pp_expand,a.pp_contract').show()}else{$('a.pp_expand').hide()}}
if(settings.autoplay_slideshow&&!pp_slideshow&&!pp_open) $.prettyPhoto.startSlideshow();settings.changepicturecallback();pp_open=true});_insert_gallery();pp_settings.ajaxcallback()};
function _hideContent(callback){$pp_pic_holder.find('#pp_full_res object,#pp_full_res embed').css('visibility','hidden');$pp_pic_holder.find('.pp_fade').fadeOut(settings.animation_speed,function(){$('.pp_loaderIcon').show();callback()})};
function _checkPosition(setCount){(setCount>1)?$('.pp_nav').show():$('.pp_nav').hide()};
function _fitToViewport(width,height){resized=false;_getDimensions(width,height);imageWidth=width,imageHeight=height;if(((pp_containerWidth>windowWidth)||(pp_containerHeight>windowHeight))&&doresize&&settings.allow_resize&&!percentBased){resized=true,fitting=false;while(!fitting){if((pp_containerWidth>windowWidth)){imageWidth=(windowWidth-200);imageHeight=(height/width) * imageWidth}else if((pp_containerHeight>windowHeight)){imageHeight=(windowHeight-200);imageWidth=(width/height) * imageHeight}else{fitting=true};pp_containerHeight=imageHeight,pp_containerWidth=imageWidth};if((pp_containerWidth>windowWidth)||(pp_containerHeight>windowHeight)){_fitToViewport(pp_containerWidth,pp_containerHeight)};_getDimensions(imageWidth,imageHeight)};return{width:Math.floor(imageWidth),height:Math.floor(imageHeight),containerHeight:Math.floor(pp_containerHeight),containerWidth:Math.floor(pp_containerWidth)+(settings.horizontal_padding * 2),contentHeight:Math.floor(pp_contentHeight),contentWidth:Math.floor(pp_contentWidth),resized:resized}};
function _getDimensions(width,height){width=parseFloat(width);height=parseFloat(height);$pp_details=$pp_pic_holder.find('.pp_details');$pp_details.width(width);detailsHeight=parseFloat($pp_details.css('marginTop'))+parseFloat($pp_details.css('marginBottom'));$pp_details=$pp_details.clone().addClass(settings.theme).width(width).appendTo($('body')).css({'position':'absolute','top':-10000});detailsHeight+=$pp_details.height();detailsHeight=(detailsHeight<=34)?36:detailsHeight;$pp_details.remove();$pp_title=$pp_pic_holder.find('.ppt');$pp_title.width(width);titleHeight=parseFloat($pp_title.css('marginTop'))+parseFloat($pp_title.css('marginBottom'));$pp_title=$pp_title.clone().appendTo($('body')).css({'position':'absolute','top':-10000});titleHeight+=$pp_title.height();$pp_title.remove();pp_contentHeight=height+detailsHeight;pp_contentWidth=width;pp_containerHeight=pp_contentHeight+titleHeight+$pp_pic_holder.find('.pp_top').height()+$pp_pic_holder.find('.pp_bottom').height();pp_containerWidth=width}
function _getFileType(itemSrc){if(itemSrc.match(/youtube\.com\/watch/i) || itemSrc.match(/youtu\.be/i)){return 'youtube'}else if(itemSrc.match(/vimeo\.com/i)){return 'vimeo'}else if(itemSrc.match(/\b.mov\b/i)){return 'quicktime'}else if(itemSrc.match(/\b.swf\b/i)){return 'flash'}else if(itemSrc.match(/\biframe=true\b/i)){return 'iframe'}else if(itemSrc.match(/\bajax=true\b/i)){return 'ajax'}else if(itemSrc.match(/\bcustom=true\b/i)){return 'custom'}else if(itemSrc.substr(0,1)=='#'){return 'inline'}else{return 'image'}};
function _center_overlay(){if(doresize&&typeof $pp_pic_holder!='undefined'){scroll_pos=_get_scroll();contentHeight=$pp_pic_holder.height(),contentwidth=$pp_pic_holder.width();projectedTop=(windowHeight/2)+scroll_pos['scrollTop']-(contentHeight/2);if(projectedTop<0) projectedTop=0;if(contentHeight>windowHeight)
return;$pp_pic_holder.css({'top':projectedTop,'left':(windowWidth/2)+scroll_pos['scrollLeft']-(contentwidth/2)})}};
function _get_scroll(){if(self.pageYOffset){return{scrollTop:self.pageYOffset,scrollLeft:self.pageXOffset}} else if(document.documentElement&&document.documentElement.scrollTop){return{scrollTop:document.documentElement.scrollTop,scrollLeft:document.documentElement.scrollLeft}} else if(document.body){return{scrollTop:document.body.scrollTop,scrollLeft:document.body.scrollLeft}}};
function _resize_overlay(){windowHeight=$(window).height(),windowWidth=$(window).width();if(typeof $pp_overlay!="undefined") $pp_overlay.height($(document).height()).width(windowWidth)};
function _insert_gallery(){if(isSet&&settings.overlay_gallery&&_getFileType(pp_images[set_position])=="image"){itemWidth=52+5;navWidth=(settings.theme=="facebook"||settings.theme=="pp_default")?50:30;itemsPerPage=Math.floor((pp_dimensions['containerWidth']-100-navWidth)/itemWidth);itemsPerPage=(itemsPerPage<pp_images.length)?itemsPerPage:pp_images.length;totalPage=Math.ceil(pp_images.length/itemsPerPage)-1;if(totalPage==0){navWidth=0;$pp_gallery.find('.pp_arrow_next,.pp_arrow_previous').hide()}else{$pp_gallery.find('.pp_arrow_next,.pp_arrow_previous').show()};galleryWidth=itemsPerPage * itemWidth;fullGalleryWidth=pp_images.length * itemWidth;$pp_gallery.css('margin-left',-((galleryWidth/2)+(navWidth/2))).find('div:first').width(galleryWidth+5).find('ul').width(fullGalleryWidth).find('li.selected').removeClass('selected');goToPage=(Math.floor(set_position/itemsPerPage)<totalPage)?Math.floor(set_position/itemsPerPage):totalPage;$.prettyPhoto.changeGalleryPage(goToPage);$pp_gallery_li.filter(':eq('+set_position+')').addClass('selected')}else{$pp_pic_holder.find('.pp_content').unbind('mouseenter mouseleave')}}
function _build_overlay(caller){if(settings.social_tools)
facebook_like_link=settings.social_tools.replace('{location_href}',encodeURIComponent(location.href));settings.markup=settings.markup.replace('{pp_social}','');$('body').append(settings.markup);$pp_pic_holder=$('.pp_pic_holder'),$ppt=$('.ppt'),$pp_overlay=$('div.pp_overlay');if(isSet&&settings.overlay_gallery){currentGalleryPage=0;toInject="";for(var i=0;i<pp_images.length;i++){if(!pp_images[i].match(/\b(jpg|jpeg|png|gif)\b/gi)){classname='default';img_src=''}else{classname='';img_src=pp_images[i]}
toInject+="<li class='"+classname+"'><a href='#'><img src='"+img_src+"' width='50' alt='' /></a></li>"};toInject=settings.gallery_markup.replace(/{gallery}/g,toInject);$pp_pic_holder.find('#pp_full_res').after(toInject);$pp_gallery=$('.pp_pic_holder .pp_gallery'),$pp_gallery_li=$pp_gallery.find('li');$pp_gallery.find('.pp_arrow_next').click(function(){$.prettyPhoto.changeGalleryPage('next');$.prettyPhoto.stopSlideshow();return false});$pp_gallery.find('.pp_arrow_previous').click(function(){$.prettyPhoto.changeGalleryPage('previous');$.prettyPhoto.stopSlideshow();return false});$pp_pic_holder.find('.pp_content').hover(
function(){$pp_pic_holder.find('.pp_gallery:not(.disabled)').fadeIn()},
function(){$pp_pic_holder.find('.pp_gallery:not(.disabled)').fadeOut()});itemWidth=52+5;$pp_gallery_li.each(function(i){$(this).find('a').click(function(){$.prettyPhoto.changePage(i);$.prettyPhoto.stopSlideshow();return false})})};if(settings.slideshow){$pp_pic_holder.find('.pp_nav').prepend('<a href="#" class="pp_play">Play</a>')
$pp_pic_holder.find('.pp_nav .pp_play').click(function(){$.prettyPhoto.startSlideshow();return false})}
$pp_pic_holder.attr('class','pp_pic_holder '+settings.theme);$pp_overlay.css({'opacity':0,'height':$(document).height(),'width':$(window).width()}).bind('click',function(){if(!settings.modal) $.prettyPhoto.close()});$('a.pp_close').bind('click',function(){$.prettyPhoto.close();return false});if(settings.allow_expand){$('a.pp_expand').bind('click',function(e){if($(this).hasClass('pp_expand')){$(this).removeClass('pp_expand').addClass('pp_contract');doresize=false}else{$(this).removeClass('pp_contract').addClass('pp_expand');doresize=true};_hideContent(function(){$.prettyPhoto.open()});return false})}
$pp_pic_holder.find('.pp_previous, .pp_nav .pp_arrow_previous').bind('click',function(){$.prettyPhoto.changePage('previous');$.prettyPhoto.stopSlideshow();return false});$pp_pic_holder.find('.pp_next, .pp_nav .pp_arrow_next').bind('click',function(){$.prettyPhoto.changePage('next');$.prettyPhoto.stopSlideshow();return false});_center_overlay()};if(!pp_alreadyInitialized&&getHashtag()){pp_alreadyInitialized=true;hashIndex=getHashtag();hashRel=hashIndex;hashIndex=hashIndex.substring(hashIndex.indexOf('/')+1,hashIndex.length-1);hashRel=hashRel.substring(0,hashRel.indexOf('/'));setTimeout(function(){$("a["+pp_settings.hook+"^='"+hashRel+"']:eq("+hashIndex+")").trigger('click')},50)}
return this.unbind('click.prettyphoto').bind('click.prettyphoto',$.prettyPhoto.initialize)};
function getHashtag(){var url=location.href;hashtag=(url.indexOf('#prettyPhoto')!==-1)?decodeURI(url.substring(url.indexOf('#prettyPhoto')+1,url.length)):false;return hashtag};
function setHashtag(){if(typeof theRel=='undefined') return;location.hash=theRel+'/'+rel_index+'/'};
function clearHashtag(){if(location.href.indexOf('#prettyPhoto')!==-1) location.hash="prettyPhoto"}
function getParam(name,url){name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(url);return(results==null)?"":results[1]}})(jQuery);var pp_alreadyInitialized=false;

/* - prettyPhoto.js - */
// https://is.enes.org/portal_javascripts/prettyPhoto.js?original=1
var plonePrettyPhoto={};(function($){plonePrettyPhoto.enable=function(){$("a.prettyPhoto").attr({"rel":"prettyPhoto"});$("a.prettyPhotoIframe").attr("href", function(){return this.href+"?iframe=true&width=75%&height=75%"}).attr({"rel":"prettyPhoto"});$("a[rel^='prettyPhoto']").prettyPhoto({animation_speed:'normal',opacity:0.80,show_title:true,counter_separator_label:'/',theme:'light_rounded',autoplay:true,autoplay_slideshow:false,slideshow:false,overlay_gallery:false,social_tools:false,deeplinking:false,markup:undefined})};$(function(){plonePrettyPhoto.enable()})})(jQuery);

/* - ++resource++plone.formwidget.recurrence/jquery.tmpl-beta1.js - */
// https://is.enes.org/portal_javascripts/++resource++plone.formwidget.recurrence/jquery.tmpl-beta1.js?original=1
(function(jQuery,undefined){var oldManip=jQuery.fn.domManip,tmplItmAtt="_tmplitem",htmlExpr=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,newTmplItems={},wrappedItems={},appendToTmplItems,topTmplItem={key:0,data:{}},itemKey=0,cloneIndex=0,stack=[];
function newTmplItem(options,parentItem,fn,data){var newItem={data:data||(parentItem?parentItem.data:{}),_wrap:parentItem?parentItem._wrap:null,tmpl:null,parent:parentItem||null,nodes:[],calls:tiCalls,nest:tiNest,wrap:tiWrap,html:tiHtml,update:tiUpdate};if(options){jQuery.extend(newItem,options,{nodes:[],parent:parentItem})}
if(fn){newItem.tmpl=fn;newItem._ctnt=newItem._ctnt||newItem.tmpl(jQuery,newItem);newItem.key=++itemKey;(stack.length?wrappedItems:newTmplItems)[itemKey]=newItem}
return newItem}
jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"}, function(name,original){jQuery.fn[name]=function(selector){var ret=[],insert=jQuery(selector),elems,i,l,tmplItems,parent=this.length===1&&this[0].parentNode;appendToTmplItems=newTmplItems||{};if(parent&&parent.nodeType===11&&parent.childNodes.length===1&&insert.length===1){insert[original](this[0]);ret=this} else{for(i=0,l=insert.length;i<l;i++){cloneIndex=i;elems=(i>0?this.clone(true):this).get();jQuery.fn[original].apply(jQuery(insert[i]),elems);ret=ret.concat(elems)}
cloneIndex=0;ret=this.pushStack(ret,name,insert.selector)}
tmplItems=appendToTmplItems;appendToTmplItems=null;jQuery.tmpl.complete(tmplItems);return ret}});jQuery.fn.extend({tmpl: function(data,options,parentItem){return jQuery.tmpl(this[0],data,options,parentItem)},tmplItem: function(){return jQuery.tmplItem(this[0])},template: function(name){return jQuery.template(name,this[0])},domManip: function(args,table,callback,options){if(args[0]&&args[0].nodeType){var dmArgs=jQuery.makeArray(arguments),argsLength=args.length,i=0,tmplItem;while(i<argsLength&&!(tmplItem=jQuery.data(args[i++],"tmplItem"))){}
if(argsLength>1){dmArgs[0]=[jQuery.makeArray(args)]}
if(tmplItem&&cloneIndex){dmArgs[2]=function(fragClone){jQuery.tmpl.afterManip(this,fragClone,callback)}}
oldManip.apply(this,dmArgs)} else{oldManip.apply(this,arguments)}
cloneIndex=0;if(!appendToTmplItems){jQuery.tmpl.complete(newTmplItems)}
return this}});jQuery.extend({tmpl: function(tmpl,data,options,parentItem){var ret,topLevel=!parentItem;if(topLevel){parentItem=topTmplItem;tmpl=jQuery.template[tmpl]||jQuery.template(null,tmpl);wrappedItems={}} else if(!tmpl){tmpl=parentItem.tmpl;newTmplItems[parentItem.key]=parentItem;parentItem.nodes=[];if(parentItem.wrapped){updateWrapped(parentItem,parentItem.wrapped)}
return jQuery(build(parentItem,null,parentItem.tmpl(jQuery,parentItem)))}
if(!tmpl){return []}
if(typeof data==="function"){data=data.call(parentItem||{})}
if(options&&options.wrapped){updateWrapped(options,options.wrapped)}
ret=jQuery.isArray(data)?jQuery.map(data, function(dataItem){return dataItem?newTmplItem(options,parentItem,tmpl,dataItem):null}):[newTmplItem(options,parentItem,tmpl,data)];return topLevel?jQuery(build(parentItem,null,ret)):ret},tmplItem: function(elem){var tmplItem;if(elem instanceof jQuery){elem=elem[0]}
while(elem&&elem.nodeType===1&&!(tmplItem=jQuery.data(elem,"tmplItem"))&&(elem=elem.parentNode)){}
return tmplItem||topTmplItem},template: function(name,tmpl){if(tmpl){if(typeof tmpl==="string"){tmpl=buildTmplFn(tmpl)} else if(tmpl instanceof jQuery){tmpl=tmpl[0]||{}}
if(tmpl.nodeType){tmpl=jQuery.data(tmpl,"tmpl")||jQuery.data(tmpl,"tmpl",buildTmplFn(tmpl.innerHTML))}
return typeof name==="string"?(jQuery.template[name]=tmpl):tmpl}
return name?(typeof name!=="string"?jQuery.template(null,name):(jQuery.template[name]||jQuery.template(null,htmlExpr.test(name)?name:jQuery(name)))):null},encode: function(text){return(""+text).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});jQuery.extend(jQuery.tmpl,{tag:{"tmpl":{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},"wrap":{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},"each":{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},"html":{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete: function(items){newTmplItems={}},afterManip: function afterManip(elem,fragClone,callback){var content=fragClone.nodeType===11?jQuery.makeArray(fragClone.childNodes):fragClone.nodeType===1?[fragClone]:[];callback.call(elem,fragClone);storeTmplItems(content);cloneIndex++}});
function build(tmplItem,nested,content){var frag,ret=content?jQuery.map(content, function(item){return(typeof item==="string")?(tmplItem.key?item.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+tmplItmAtt+"=\""+tmplItem.key+"\" $2"):item):build(item,tmplItem,item._ctnt)}):tmplItem;if(nested){return ret}
ret=ret.join("");ret.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/, function(all,before,middle,after){frag=jQuery(middle).get();storeTmplItems(frag);if(before){frag=unencode(before).concat(frag)}
if(after){frag=frag.concat(unencode(after))}});return frag?frag:unencode(ret)}
function unencode(text){var el=document.createElement("div");el.innerHTML=text;return jQuery.makeArray(el.childNodes)}
function buildTmplFn(markup){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;"+"with($data){_.push('"+jQuery.trim(markup).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(all,slash,type,fnargs,target,parens,args){var tag=jQuery.tmpl.tag[type],def,expr,exprAutoFnDetect;if(!tag){throw "Template command not found: "+type}
def=tag._default||[];if(parens&&!/\w$/.test(target)){target+=parens;parens=""}
if(target){target=unescape(target);args=args?(","+unescape(args)+")"):(parens?")":"");expr=parens?(target.indexOf(".")>-1?target+parens:("("+target+").call($item"+args)):target;exprAutoFnDetect=parens?expr:"(typeof("+target+")==='function'?("+target+").call($item):("+target+"))"} else{exprAutoFnDetect=expr=def.$1||"null"}
fnargs=unescape(fnargs);return "');"+tag[slash?"close":"open"].split("$notnull_1").join(target?"typeof("+target+")!=='undefined' && ("+target+")!=null":"true").split("$1a").join(exprAutoFnDetect).split("$1").join(expr).split("$2").join(fnargs?fnargs.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g, function(all,name,parens,params){params=params?(","+params+")"):(parens?")":"");return params?("("+name+").call($item"+params):all}):(def.$2||""))+"_.push('"})+"');}return _;")}
function updateWrapped(options,wrapped){options._wrap=build(options,true,jQuery.isArray(wrapped)?wrapped:[htmlExpr.test(wrapped)?wrapped:jQuery(wrapped).html()]).join("")}
function unescape(args){return args?args.replace(/\\'/g, "'").replace(/\\\\/g, "\\"):null}
function outerHtml(elem){var div=document.createElement("div");div.appendChild(elem.cloneNode(true));return div.innerHTML}
function storeTmplItems(content){var keySuffix="_"+cloneIndex,elem,elems,newClonedItems={},i,l,m;for(i=0,l=content.length;i<l;i++){if((elem=content[i]).nodeType!==1){continue}
elems=elem.getElementsByTagName("*");for(m=elems.length-1;m>=0;m--){processItemKey(elems[m])}
processItemKey(elem)}
function processItemKey(el){var pntKey,pntNode=el,pntItem,tmplItem,key;if((key=el.getAttribute(tmplItmAtt))){while(pntNode.parentNode&&(pntNode=pntNode.parentNode).nodeType===1&&!(pntKey=pntNode.getAttribute(tmplItmAtt))){}
if(pntKey!==key){pntNode=pntNode.parentNode?(pntNode.nodeType===11?0:(pntNode.getAttribute(tmplItmAtt)||0)):0;if(!(tmplItem=newTmplItems[key])){tmplItem=wrappedItems[key];tmplItem=newTmplItem(tmplItem,newTmplItems[pntNode]||wrappedItems[pntNode],null,true);tmplItem.key=++itemKey;newTmplItems[itemKey]=tmplItem}
if(cloneIndex){cloneTmplItem(key)}}
el.removeAttribute(tmplItmAtt)} else if(cloneIndex&&(tmplItem=jQuery.data(el,"tmplItem"))){cloneTmplItem(tmplItem.key);newTmplItems[tmplItem.key]=tmplItem;pntNode=jQuery.data(el.parentNode,"tmplItem");pntNode=pntNode?pntNode.key:0}
if(tmplItem){pntItem=tmplItem;while(pntItem&&pntItem.key!=pntNode){pntItem.nodes.push(el);pntItem=pntItem.parent}
delete tmplItem._ctnt;delete tmplItem._wrap;jQuery.data(el,"tmplItem",tmplItem)}
function cloneTmplItem(key){key=key+keySuffix;tmplItem=newClonedItems[key]=(newClonedItems[key]||newTmplItem(tmplItem,newTmplItems[tmplItem.parent.key+keySuffix]||tmplItem.parent,null,true))}}}
function tiCalls(content,tmpl,data,options){if(!content){return stack.pop()}
stack.push({_:content,tmpl:tmpl,item:this,data:data,options:options})}
function tiNest(tmpl,data,options){return jQuery.tmpl(jQuery.template(tmpl),data,options,this)}
function tiWrap(call,wrapped){var options=call.options||{};options.wrapped=wrapped;return jQuery.tmpl(jQuery.template(call.tmpl),call.data,options,call.item)}
function tiHtml(filter,textOnly){var wrapped=this._wrap;return jQuery.map(jQuery(jQuery.isArray(wrapped)?wrapped.join(""):wrapped).filter(filter||"*"),
function(e){return textOnly?e.innerText||e.textContent:e.outerHTML||outerHtml(e)})}
function tiUpdate(){var coll=this.nodes;jQuery.tmpl(null,null,null,this).insertBefore(coll[0]);jQuery(coll).remove()}})(jQuery);

/* - ++resource++plone.formwidget.recurrence/jquery.recurrenceinput.js - */
// https://is.enes.org/portal_javascripts/++resource++plone.formwidget.recurrence/jquery.recurrenceinput.js?original=1
"use strict";(function($){$.tools=$.tools||{version:'@VERSION'};var tool;var LABELS={};tool=$.tools.recurrenceinput={conf:{lang:'en',readOnly:false,firstDay:0,startField:null,startFieldYear:null,startFieldMonth:null,startFieldDay:null,ajaxURL:null,ajaxContentType:'application/json; charset=utf8',ributtonExtraClass:'',hasRepeatForeverButton:true,formOverlay:{speed:'fast',fixed:false},template:{form:'#jquery-recurrenceinput-form-tmpl',display:'#jquery-recurrenceinput-display-tmpl'},rtemplate:{daily:{rrule:'FREQ=DAILY',fields:['ridailyinterval','rirangeoptions']},mondayfriday:{rrule:'FREQ=WEEKLY;BYDAY=MO,FR',fields:['rirangeoptions']},weekdays:{rrule:'FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR',fields:['rirangeoptions']},weekly:{rrule:'FREQ=WEEKLY',fields:['riweeklyinterval','riweeklyweekdays','rirangeoptions']},monthly:{rrule:'FREQ=MONTHLY',fields:['rimonthlyinterval','rimonthlyoptions','rirangeoptions']},yearly:{rrule:'FREQ=YEARLY',fields:['riyearlyinterval','riyearlyoptions','rirangeoptions']}}},localize: function(language,labels){LABELS[language]=labels},setTemplates: function(templates,titles){var lang,template;tool.conf.rtemplate=templates;for(lang in titles){if(titles.hasOwnProperty(lang)){for(template in titles[lang]){if(titles[lang].hasOwnProperty(template)){LABELS[lang].rtemplate[template]=titles[lang][template]}}}}}};tool.localize("en",{displayUnactivate:'Does not repeat',displayActivate:'Repeats every',add_rules:'Add',edit_rules:'Edit',delete_rules:'Delete',add:'Add',refresh:'Refresh',title:'Repeat',preview:'Selected dates',addDate:'Add date',recurrenceType:'Repeats:',dailyInterval1:'Repeat every:',dailyInterval2:'days',weeklyInterval1:'Repeat every:',weeklyInterval2:'week(s)',weeklyWeekdays:'Repeat on:',weeklyWeekdaysHuman:'on:',monthlyInterval1:'Repeat every:',monthlyInterval2:'month(s)',monthlyDayOfMonth1:'Day',monthlyDayOfMonth1Human:'on day',monthlyDayOfMonth2:'of the month',monthlyDayOfMonth3:'month(s)',monthlyWeekdayOfMonth1:'The',monthlyWeekdayOfMonth1Human:'on the',monthlyWeekdayOfMonth2:'',monthlyWeekdayOfMonth3:'of the month',monthlyRepeatOn:'Repeat on:',yearlyInterval1:'Repeat every:',yearlyInterval2:'year(s)',yearlyDayOfMonth1:'Every',yearlyDayOfMonth1Human:'on',yearlyDayOfMonth2:'',yearlyDayOfMonth3:'',yearlyWeekdayOfMonth1:'The',yearlyWeekdayOfMonth1Human:'on the',yearlyWeekdayOfMonth2:'',yearlyWeekdayOfMonth3:'of',yearlyWeekdayOfMonth4:'',yearlyRepeatOn:'Repeat on:',range:'End recurrence:',rangeNoEnd:'Never',rangeByOccurrences1:'After',rangeByOccurrences1Human:'ends after',rangeByOccurrences2:'occurrence(s)',rangeByEndDate:'On',rangeByEndDateHuman:'ends on',including:', and also',except:', except for',cancel:'Cancel',save:'Save',recurrenceStart:'Start of the recurrence',additionalDate:'Additional date',include:'Include',exclude:'Exclude',remove:'Remove',orderIndexes:['first','second','third','fourth','last'],months:['January','February','March','April','May','June','July','August','September','October','November','December'],shortMonths:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],weekdays:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],shortWeekdays:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],longDateFormat:'mmmm dd, yyyy',shortDateFormat:'mm/dd/yyyy',unsupportedFeatures:'Warning: This event uses recurrence features not '+'supported by this widget. Saving the recurrence '+'may change the recurrence in unintended ways:',noTemplateMatch:'No matching recurrence template',multipleDayOfMonth:'This widget does not support multiple days in monthly or yearly recurrence',bysetpos:'BYSETPOS is not supported',noRule:'No RRULE in RRULE data',noRepeatEvery:'Error: The "Repeat every"-field must be between 1 and 1000',noEndDate:'Error: End date is not set. Please set a correct value',noRepeatOn:'Error: "Repeat on"-value must be selected',pastEndDate:'Error: End date cannot be before start date',noEndAfterNOccurrences:'Error: The "After N occurrences"-field must be between 1 and 1000',alreadyAdded:'This date was already added',rtemplate:{daily:'Daily',mondayfriday:'Monday and Friday',weekdays:'Weekday',weekly:'Weekly',monthly:'Monthly',yearly:'Yearly'}});var OCCURRENCETMPL=['<div class="rioccurrences">','{{each occurrences}}','<div class="occurrence ${occurrences[$index].type}">','<span>','${occurrences[$index].formattedDate}','{{if occurrences[$index].type === "start"}}','<span class="rlabel">${i18n.recurrenceStart}</span>','{{/if}}','{{if occurrences[$index].type === "rdate"}}','<span class="rlabel">${i18n.additionalDate}</span>','{{/if}}','</span>','{{if !readOnly}}','<span class="action">','{{if occurrences[$index].type === "rrule"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.exclude}">','${i18n.exclude}','</a>','{{/if}}','{{if occurrences[$index].type === "rdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.remove}" >','${i18n.remove}','</a>','{{/if}}','{{if occurrences[$index].type === "exdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.include}">','${i18n.include}','</a>','{{/if}}','</span>','{{/if}}','</div>','{{/each}}','<div class="batching">','{{each batch.batches}}','{{if $index === batch.currentBatch}}<span class="current">{{/if}}','<a href="#" start="${batch.batches[$index][0]}">[${batch.batches[$index][0]} - ${batch.batches[$index][1]}]</a>','{{if $index === batch.currentBatch}}</span>{{/if}}','{{/each}}','</div></div>'].join('\n');$.template('occurrenceTmpl',OCCURRENCETMPL);var DISPLAYTMPL=['<div class="ridisplay">','<div class="rimain">','{{if !readOnly}}','<a href="#" name="riedit">${i18n.add_rules}</a>','<a href="#" name="ridelete" style="display:none">${i18n.delete_rules}</a>','{{/if}}','<label class="ridisplay">${i18n.displayUnactivate}</label>','</div>','<div class="rioccurrences" style="display:none" /></div>'].join('\n');$.template('displayTmpl',DISPLAYTMPL);var FORMTMPL=['<div class="riform">','<form>','<h1>${i18n.title}</h1>','<div id="messagearea" style="display: none;">','</div>','<div id="rirtemplate">','<label for="${name}rtemplate" class="label">','${i18n.recurrenceType}','</label>','<select id="rirtemplate" name="rirtemplate" class="field">','{{each rtemplate}}','<option value="${$index}">${i18n.rtemplate[$index]}</value>','{{/each}}','</select>','<div>','<div id="riformfields">','<div id="ridailyinterval" class="rifield">','<label for="${name}dailyinterval" class="label">','${i18n.dailyInterval1}','</label>','<div class="field">','<input type="text" size="2"','value="1"','name="ridailyinterval"','id="${name}dailyinterval" />','${i18n.dailyInterval2}','</div>','</div>','<div id="riweeklyinterval" class="rifield">','<label for="${name}weeklyinterval" class="label">','${i18n.weeklyInterval1}','</label>','<div class="field">','<input type="text" size="2"','value="1"','name="riweeklyinterval"','id="${name}weeklyinterval"/>','${i18n.weeklyInterval2}','</div>','</div>','<div id="riweeklyweekdays" class="rifield">','<label for="${name}weeklyinterval" class="label">${i18n.weeklyWeekdays}</label>','<div class="field">','{{each orderedWeekdays}}','<div class="riweeklyweekday">','<input type="checkbox"','name="riweeklyweekdays${weekdays[$value]}"','id="${name}weeklyWeekdays${weekdays[$value]}"','value="${weekdays[$value]}" />','<label for="${name}weeklyWeekdays${weekdays[$value]}">${i18n.shortWeekdays[$value]}</label>','</div>','{{/each}}','</div>','</div>','<div id="rimonthlyinterval" class="rifield">','<label for="rimonthlyinterval" class="label">${i18n.monthlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="rimonthlyinterval"/>','${i18n.monthlyInterval2}','</div>','</div>','<div id="rimonthlyoptions" class="rifield">','<label for="rimonthlytype" class="label">${i18n.monthlyRepeatOn}</label>','<div class="field">','<div>','<input','type="radio"','value="DAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:DAYOFMONTH" />','<label for="${name}monthlytype:DAYOFMONTH">','${i18n.monthlyDayOfMonth1}','</label>','<select name="rimonthlydayofmonthday"','id="${name}monthlydayofmonthday">','{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,','18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}','<option value="${$value}">${$value}</option>','{{/each}}','</select>','${i18n.monthlyDayOfMonth2}','</div>','<div>','<input','type="radio"','value="WEEKDAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:WEEKDAYOFMONTH" />','<label for="${name}monthlytype:WEEKDAYOFMONTH">','${i18n.monthlyWeekdayOfMonth1}','</label>','<select name="rimonthlyweekdayofmonthindex">','{{each i18n.orderIndexes}}','<option value="${orderIndexes[$index]}">${$value}</option>','{{/each}}','</select>','${i18n.monthlyWeekdayOfMonth2}','<select name="rimonthlyweekdayofmonth">','{{each orderedWeekdays}}','<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>','{{/each}}','</select>','${i18n.monthlyWeekdayOfMonth3}','</div>','</div>','</div>','<div id="riyearlyinterval" class="rifield">','<label for="riyearlyinterval" class="label">${i18n.yearlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="riyearlyinterval"/>','${i18n.yearlyInterval2}','</div>','</div>','<div id="riyearlyoptions" class="rifield">','<label for="riyearlyType" class="label">${i18n.yearlyRepeatOn}</label>','<div class="field">','<div>','<input','type="radio"','value="DAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:DAYOFMONTH" />','<label for="${name}yearlytype:DAYOFMONTH">','${i18n.yearlyDayOfMonth1}','</label>','<select name="riyearlydayofmonthmonth">','{{each i18n.months}}','<option value="${$index+1}">${$value}</option>','{{/each}}','</select>','${i18n.yearlyDayOfMonth2}','<select name="riyearlydayofmonthday">','{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,','18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}','<option value="${$value}">${$value}</option>','{{/each}}','</select>','${i18n.yearlyDayOfMonth3}','</div>','<div>','<input','type="radio"','value="WEEKDAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:WEEKDAYOFMONTH"/>','<label for="${name}yearlytype:WEEKDAYOFMONTH">','${i18n.yearlyWeekdayOfMonth1}','</label>','<select name="riyearlyweekdayofmonthindex">','{{each i18n.orderIndexes}}','<option value="${orderIndexes[$index]}">${$value}</option>','{{/each}}','</select>','<label for="${name}yearlytype:WEEKDAYOFMONTH">','${i18n.yearlyWeekdayOfMonth2}','</label>','<select name="riyearlyweekdayofmonthday">','{{each orderedWeekdays}}','<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>','{{/each}}','</select>','${i18n.yearlyWeekdayOfMonth3}','<select name="riyearlyweekdayofmonthmonth">','{{each i18n.months}}','<option value="${$index+1}">${$value}</option>','{{/each}}','</select>','${i18n.yearlyWeekdayOfMonth4}','</div>','</div>','</div>','<div id="rirangeoptions" class="rifield">','<label class="label">${i18n.range}</label>','<div class="field">','{{if hasRepeatForeverButton}}','<div>','<input','type="radio"','value="NOENDDATE"','name="rirangetype"','id="${name}rangetype:NOENDDATE"/>','<label for="${name}rangetype:NOENDDATE">','${i18n.rangeNoEnd}','</label>','</div>','{{/if}}','<div>','<input','type="radio"','checked="checked"','value="BYOCCURRENCES"','name="rirangetype"','id="${name}rangetype:BYOCCURRENCES"/>','<label for="${name}rangetype:BYOCCURRENCES">','${i18n.rangeByOccurrences1}','</label>','<input','type="text" size="3"','value="7"','name="rirangebyoccurrencesvalue" />','${i18n.rangeByOccurrences2}','</div>','<div>','<input','type="radio"','value="BYENDDATE"','name="rirangetype"','id="${name}rangetype:BYENDDATE"/>','<label for="${name}rangetype:BYENDDATE">','${i18n.rangeByEndDate}','</label>','<input','type="date"','name="rirangebyenddatecalendar" />','</div>','</div>','</div>','</div>','<div class="rioccurrencesactions">','<div class="rioccurancesheader">','<h2>${i18n.preview}</h2>','<span class="refreshbutton action">','<a class="rirefreshbutton" href="#" title="${i18n.refresh}">','${i18n.refresh}','</a>','</span>','</div>','</div>','<div class="rioccurrences">','</div>','<div class="rioccurrencesactions">','<div class="rioccurancesheader">','<h2>${i18n.addDate}</h2>','</div>','<div class="riaddoccurrence">','<div class="errorarea"></div>','<input type="date" name="adddate" id="adddate" />','<input type="button" name="addaction" id="addaction" value="${i18n.add}">','</div>','</div>','<div class="ributtons">','<input','type="submit"','class="ricancelbutton ${ributtonExtraClass}"','value="${i18n.cancel}" />','<input','type="submit"','class="risavebutton ${ributtonExtraClass}"','value="${i18n.save}" />','</div>','</form></div>'].join('\n');$.template('formTmpl',FORMTMPL);var Re=/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g;
function zeropad(val,len){val=val.toString();len=len||2;while(val.length<len){val="0"+val}
return val}
function format(date,fmt,conf){var d=date.getDate(),D=date.getDay(),m=date.getMonth(),y=date.getFullYear(),flags={d:d,dd:zeropad(d),ddd:conf.i18n.shortWeekdays[D],dddd:conf.i18n.weekdays[D],m:m+1,mm:zeropad(m+1),mmm:conf.i18n.shortMonths[m],mmmm:conf.i18n.months[m],yy:String(y).slice(2),yyyy:y};var result=fmt.replace(Re, function($0){return flags.hasOwnProperty($0)?flags[$0]:$0.slice(1,$0.length-1)});return result}
function widgetSaveToRfc5545(form,conf,tz){var value=form.find('select[name=rirtemplate]').val();var rtemplate=conf.rtemplate[value];var result=rtemplate.rrule;var human=conf.i18n.rtemplate[value];var field,input,weekdays,i18nweekdays,i,j,index,tmp;var day,month,year,interval,yearlyType,occurrences,date;for(i=0;i<rtemplate.fields.length;i++){field=form.find('#'+rtemplate.fields[i]);switch(field.attr('id')){case 'ridailyinterval':interval=field.find('input[name=ridailyinterval]').val();if(interval!=='1'){result+=';INTERVAL='+interval}
human=interval+' '+conf.i18n.dailyInterval2;break;case 'riweeklyinterval':interval=field.find('input[name=riweeklyinterval]').val();if(interval!=='1'){result+=';INTERVAL='+interval}
human=interval+' '+conf.i18n.weeklyInterval2;break;case 'riweeklyweekdays':weekdays='';i18nweekdays='';for(j=0;j<conf.weekdays.length;j++){input=field.find('input[name=riweeklyweekdays'+conf.weekdays[j]+']');if(input.is(':checked')){if(weekdays){weekdays+=',';i18nweekdays+=', '}
weekdays+=conf.weekdays[j];i18nweekdays+=conf.i18n.weekdays[j]}}
if(weekdays){result+=';BYDAY='+weekdays;human+=' '+conf.i18n.weeklyWeekdaysHuman+' '+i18nweekdays}
break;case 'rimonthlyinterval':interval=field.find('input[name=rimonthlyinterval]').val();if(interval!=='1'){result+=';INTERVAL='+interval}
human=interval+' '+conf.i18n.monthlyInterval2;break;case 'rimonthlyoptions':var monthlyType=$('input[name=rimonthlytype]:checked',form).val();switch(monthlyType){case 'DAYOFMONTH':day=$('select[name=rimonthlydayofmonthday]',form).val();result+=';BYMONTHDAY='+day;human+=', '+conf.i18n.monthlyDayOfMonth1Human+' '+day+' '+conf.i18n.monthlyDayOfMonth2;break;case 'WEEKDAYOFMONTH':index=$('select[name=rimonthlyweekdayofmonthindex]',form).val();day=$('select[name=rimonthlyweekdayofmonth]',form).val();if($.inArray(day,['MO','TU','WE','TH','FR','SA','SU'])>-1){result+=';BYDAY='+index+day;human+=', '+conf.i18n.monthlyWeekdayOfMonth1Human+' ';human+=' '+conf.i18n.orderIndexes[$.inArray(index,conf.orderIndexes)];human+=' '+conf.i18n.monthlyWeekdayOfMonth2;human+=' '+conf.i18n.weekdays[$.inArray(day,conf.weekdays)];human+=' '+conf.i18n.monthlyDayOfMonth2}
break}
break;case 'riyearlyinterval':interval=field.find('input[name=riyearlyinterval]').val();if(interval!=='1'){result+=';INTERVAL='+interval}
human=interval+' '+conf.i18n.yearlyInterval2;break;case 'riyearlyoptions':yearlyType=$('input[name=riyearlyType]:checked',form).val();switch(yearlyType){case 'DAYOFMONTH':month=$('select[name=riyearlydayofmonthmonth]',form).val();day=$('select[name=riyearlydayofmonthday]',form).val();result+=';BYMONTH='+month;result+=';BYMONTHDAY='+day;human+=', '+conf.i18n.yearlyDayOfMonth1Human+' '+conf.i18n.months[month-1]+' '+day;break;case 'WEEKDAYOFMONTH':index=$('select[name=riyearlyweekdayofmonthindex]',form).val();day=$('select[name=riyearlyweekdayofmonthday]',form).val();month=$('select[name=riyearlyweekdayofmonthmonth]',form).val();result+=';BYMONTH='+month;if($.inArray(day,['MO','TU','WE','TH','FR','SA','SU'])>-1){result+=';BYDAY='+index+day;human+=', '+conf.i18n.yearlyWeekdayOfMonth1Human;human+=' '+conf.i18n.orderIndexes[$.inArray(index,conf.orderIndexes)];human+=' '+conf.i18n.yearlyWeekdayOfMonth2;human+=' '+conf.i18n.weekdays[$.inArray(day,conf.weekdays)];human+=' '+conf.i18n.yearlyWeekdayOfMonth3;human+=' '+conf.i18n.months[month-1];human+=' '+conf.i18n.yearlyWeekdayOfMonth4}
break}
break;case 'rirangeoptions':var rangeType=form.find('input[name=rirangetype]:checked').val();switch(rangeType){case 'BYOCCURRENCES':occurrences=form.find('input[name=rirangebyoccurrencesvalue]').val();result+=';COUNT='+occurrences;human+=', '+conf.i18n.rangeByOccurrences1Human;human+=' '+occurrences;human+=' '+conf.i18n.rangeByOccurrences2;break;case 'BYENDDATE':field=form.find('input[name=rirangebyenddatecalendar]');date=field.data('dateinput').getValue('yyyymmdd');result+=';UNTIL='+date+'T000000';if(tz===true){result+='Z'}
human+=', '+conf.i18n.rangeByEndDateHuman;human+=' '+field.data('dateinput').getValue(conf.i18n.longDateFormat);break}
break}}
if(form.ical.RDATE!==undefined&&form.ical.RDATE.length>0){form.ical.RDATE.sort();tmp=[];for(i=0;i<form.ical.RDATE.length;i++){if(form.ical.RDATE[i]!==''){year=parseInt(form.ical.RDATE[i].substring(0,4),10);month=parseInt(form.ical.RDATE[i].substring(4,6),10)-1;day=parseInt(form.ical.RDATE[i].substring(6,8),10);tmp.push(format(new Date(year,month,day),conf.i18n.longDateFormat,conf))}}
if(tmp.length!==0){human=human+conf.i18n.including+' '+tmp.join('; ')}}
if(form.ical.EXDATE!==undefined&&form.ical.EXDATE.length>0){form.ical.EXDATE.sort();tmp=[];for(i=0;i<form.ical.EXDATE.length;i++){if(form.ical.EXDATE[i]!==''){year=parseInt(form.ical.EXDATE[i].substring(0,4),10);month=parseInt(form.ical.EXDATE[i].substring(4,6),10)-1;day=parseInt(form.ical.EXDATE[i].substring(6,8),10);tmp.push(format(new Date(year,month,day),conf.i18n.longDateFormat,conf))}}
if(tmp.length!==0){human=human+conf.i18n.except+' '+tmp.join('; ')}}
result='RRULE:'+result;if(form.ical.EXDATE!==undefined&&form.ical.EXDATE.join()!==""){tmp=$.map(form.ical.EXDATE, function(x){if(x.length===8){x+='T000000'}
if(tz===true){x+='Z'}
return x});result=result+'\nEXDATE:'+tmp}
if(form.ical.RDATE!==undefined&&form.ical.RDATE.join()!==""){tmp=$.map(form.ical.RDATE, function(x){if(x.length===8){x+='T000000'}
if(tz===true){x+='Z'}
return x});result=result+'\nRDATE:'+tmp}
return{result:result,description:human}}
function parseLine(icalline){var result={};var pos=icalline.indexOf(':');var property=icalline.substring(0,pos);result.value=icalline.substring(pos+1);if(property.indexOf(';')!==-1){pos=property.indexOf(';');result.parameters=property.substring(pos+1);result.property=property.substring(0,pos)} else{result.parameters=null;result.property=property}
return result}
function cleanDates(dates){var result=[];var splitDates=dates.split(',');var date;for(date in splitDates){if(splitDates.hasOwnProperty(date)){if(splitDates[date].indexOf('Z')!==-1){result.push(splitDates[date].substring(0,15))} else{result.push(splitDates[date])}}}
return result}
function parseIcal(icaldata){var lines=[];var result={};var propAndValue=[];var line=null;var nextline;lines=icaldata.split('\n');lines.reverse();while(true){if(lines.length>0){nextline=lines.pop();if(nextline.charAt(0)===' '||nextline.charAt(0)==='\t'){line=line+nextline;continue}} else{nextline=''}
if(line!==null){line=parseLine(line);if(line.property==='RDATE'||line.property==='EXDATE'){result[line.property]=cleanDates(line.value)} else{result[line.property]=line.value}}
line=nextline;if(line===''){break}}
return result}
function widgetLoadFromRfc5545(form,conf,icaldata,force){var unsupportedFeatures=[];var i,matches,match,matchIndex,rtemplate,d,input,index;var selector,selectors,field,radiobutton,start,end;var interval,byday,bymonth,bymonthday,count,until;var day,month,year,weekday,ical;form.ical=parseIcal(icaldata);if(form.ical.RRULE===undefined){unsupportedFeatures.push(conf.i18n.noRule);if(!force){return-1}} else{matches=/INTERVAL=([0-9]+);?/.exec(form.ical.RRULE);if(matches){interval=matches[1]} else{interval='1'}
matches=/BYDAY=([^;]+);?/.exec(form.ical.RRULE);if(matches){byday=matches[1]} else{byday=''}
matches=/BYMONTHDAY=([^;]+);?/.exec(form.ical.RRULE);if(matches){bymonthday=matches[1].split(",")} else{bymonthday=null}
matches=/BYMONTH=([^;]+);?/.exec(form.ical.RRULE);if(matches){bymonth=matches[1].split(",")} else{bymonth=null}
matches=/COUNT=([0-9]+);?/.exec(form.ical.RRULE);if(matches){count=matches[1]} else{count=null}
matches=/UNTIL=([0-9T]+);?/.exec(form.ical.RRULE);if(matches){until=matches[1]} else{until=null}
matches=/BYSETPOS=([^;]+);?/.exec(form.ical.RRULE);if(matches){unsupportedFeatures.push(conf.i18n.bysetpos)}
match='';matchIndex=null;for(i in conf.rtemplate){if(conf.rtemplate.hasOwnProperty(i)){rtemplate=conf.rtemplate[i];if(form.ical.RRULE.indexOf(rtemplate.rrule)===0){if(form.ical.RRULE.length>match.length){match=form.ical.RRULE;matchIndex=i}}}}
if(match){rtemplate=conf.rtemplate[matchIndex];selector=form.find('select[name=rirtemplate]').val(matchIndex)} else{for(rtemplate in conf.rtemplate){if(conf.rtemplate.hasOwnProperty(rtemplate)){rtemplate=conf.rtemplate[rtemplate];break}}
unsupportedFeatures.push(conf.i18n.noTemplateMatch)}
for(i=0;i<rtemplate.fields.length;i++){field=form.find('#'+rtemplate.fields[i]);switch(field.attr('id')){case 'ridailyinterval':field.find('input[name=ridailyinterval]').val(interval);break;case 'riweeklyinterval':field.find('input[name=riweeklyinterval]').val(interval);break;case 'riweeklyweekdays':byday=byday.split(",");for(d=0;d<conf.weekdays.length;d++){day=conf.weekdays[d];input=field.find('input[name=riweeklyweekdays'+day+']');input.attr('checked',$.inArray(day,byday)!==-1)}
break;case 'rimonthlyinterval':field.find('input[name=rimonthlyinterval]').val(interval);break;case 'rimonthlyoptions':var monthlyType='DAYOFMONTH';if(bymonthday){monthlyType='DAYOFMONTH';if(bymonthday.length>1){unsupportedFeatures.push(conf.i18n.multipleDayOfMonth);bymonthday=bymonthday[0]}
field.find('select[name=rimonthlydayofmonthday]').val(bymonthday)}
if(byday){monthlyType='WEEKDAYOFMONTH';if(byday.indexOf(',')!==-1){unsupportedFeatures.push(conf.i18n.multipleDayOfMonth);byday=byday.split(",")[0]}
index=byday.slice(0,-2);if(index.charAt(0)!=='+'&&index.charAt(0)!=='-'){index='+'+index}
weekday=byday.slice(-2);field.find('select[name=rimonthlyweekdayofmonthindex]').val(index);field.find('select[name=rimonthlyweekdayofmonth]').val(weekday)}
selectors=field.find('input[name=rimonthlytype]');for(index=0;index<selectors.length;index++){radiobutton=selectors[index];$(radiobutton).attr('checked',radiobutton.value===monthlyType)}
break;case 'riyearlyinterval':field.find('input[name=riyearlyinterval]').val(interval);break;case 'riyearlyoptions':var yearlyType='DAYOFMONTH';if(bymonthday){yearlyType='DAYOFMONTH';if(bymonthday.length>1){unsupportedFeatures.push(conf.i18n.multipleDayOfMonth);bymonthday=bymonthday[0]}
field.find('select[name=riyearlydayofmonthmonth]').val(bymonth);field.find('select[name=riyearlydayofmonthday]').val(bymonthday)}
if(byday){yearlyType='WEEKDAYOFMONTH';if(byday.indexOf(',')!==-1){unsupportedFeatures.push(conf.i18n.multipleDayOfMonth);byday=byday.split(",")[0]}
index=byday.slice(0,-2);if(index.charAt(0)!=='+'&&index.charAt(0)!=='-'){index='+'+index}
weekday=byday.slice(-2);field.find('select[name=riyearlyweekdayofmonthindex]').val(index);field.find('select[name=riyearlyweekdayofmonthday]').val(weekday);field.find('select[name=riyearlyweekdayofmonthmonth]').val(bymonth)}
selectors=field.find('input[name=riyearlyType]');for(index=0;index<selectors.length;index++){radiobutton=selectors[index];$(radiobutton).attr('checked',radiobutton.value===yearlyType)}
break;case 'rirangeoptions':var rangeType='NOENDDATE';if(count){rangeType='BYOCCURRENCES';field.find('input[name=rirangebyoccurrencesvalue]').val(count)}
if(until){rangeType='BYENDDATE';input=field.find('input[name=rirangebyenddatecalendar]');year=until.slice(0,4);month=until.slice(4,6);month=parseInt(month,10)-1;day=until.slice(6,8);input.data('dateinput').setValue(new Date(year,month,day))}
selectors=field.find('input[name=rirangetype]');for(index=0;index<selectors.length;index++){radiobutton=selectors[index];$(radiobutton).attr('checked',radiobutton.value===rangeType)}
break}}}
var messagearea=form.find('#messagearea');if(unsupportedFeatures.length!==0){messagearea.text(conf.i18n.unsupportedFeatures+' '+unsupportedFeatures.join('; '));messagearea.show();return 1} else{messagearea.text('');messagearea.hide();return 0}}
function RecurrenceInput(conf,textarea){var self=this;var form,display;var orderedWeekdays=[];var index,i;for(i=0;i<7;i++){index=i+conf.firstDay;if(index>6){index=index-7}
orderedWeekdays.push(index)}
$.extend(conf,{orderIndexes:['+1','+2','+3','+4','-1'],weekdays:['SU','MO','TU','WE','TH','FR','SA'],orderedWeekdays:orderedWeekdays});
function displayFields(selector){var i;form.find('.rifield').hide();var value=selector.val();if(value){var rtemplate=conf.rtemplate[value];for(i=0;i<rtemplate.fields.length;i++){form.find('#'+rtemplate.fields[i]).show()}}}
function occurrenceExclude(event){event.preventDefault();if(form.ical.EXDATE===undefined){form.ical.EXDATE=[]}
form.ical.EXDATE.push(this.attributes.date.value);var $this=$(this);$this.attr('class','exdate');$this.parent().parent().addClass('exdate');$this.unbind(event);$this.click(occurrenceInclude)}
function occurrenceInclude(event){event.preventDefault();form.ical.EXDATE.splice($.inArray(this.attributes.date.value,form.ical.EXDATE),1);var $this=$(this);$this.attr('class','rrule');$this.parent().parent().removeClass('exdate');$this.unbind(event);$this.click(occurrenceExclude)}
function occurrenceDelete(event){event.preventDefault();form.ical.RDATE.splice($.inArray(this.attributes.date.value,form.ical.RDATE),1);$(this).parent().parent().hide('slow', function(){$(this).remove()})}
function occurrenceAdd(event){event.preventDefault();var dateinput=form.find('.riaddoccurrence input#adddate').data('dateinput');var datevalue=dateinput.getValue('yyyymmddT000000');if(form.ical.RDATE===undefined){form.ical.RDATE=[]}
var errorarea=form.find('.riaddoccurrence div.errorarea');errorarea.text('');errorarea.hide();if($.inArray(datevalue,form.ical.RDATE)===-1){form.ical.RDATE.push(datevalue);var html=['<div class="occurrence rdate" style="display: none;">','<span class="rdate">',dateinput.getValue(conf.i18n.longDateFormat),'<span class="rlabel">'+conf.i18n.additionalDate+'</span>','</span>','<span class="action">','<a date="'+datevalue+'" href="#" class="rdate" >','Include','</a>','</span>','</div>'].join('\n');form.find('div.rioccurrences').prepend(html);$(form.find('div.rioccurrences div')[0]).slideDown();$(form.find('div.rioccurrences .action a.rdate')[0]).click(occurrenceDelete)} else{errorarea.text(conf.i18n.alreadyAdded).show()}}
function loadOccurrences(startdate,rfc5545,start,readonly){var element,occurrenceDiv;if(!readonly){element=form} else{element=display}
occurrenceDiv=element.find('.rioccurrences');occurrenceDiv.hide();var year,month,day;year=startdate.getFullYear();month=startdate.getMonth()+1;day=startdate.getDate();var data={year:year,month:month,day:day,rrule:rfc5545,format:conf.i18n.longDateFormat,start:start};var dict={url:conf.ajaxURL,async:false,type:'post',dataType:'json',contentType:conf.ajaxContentType,cache:false,data:data,success: function(data,status,jqXHR){var result,element;if(!readonly){element=form} else{element=display}
data.readOnly=readonly;data.i18n=conf.i18n;var occurrence,date,y,m,d,each;for(each in data.occurrences){if(data.occurrences.hasOwnProperty(each)){occurrence=data.occurrences[each];date=occurrence.date;y=parseInt(date.substring(0,4),10);m=parseInt(date.substring(4,6),10)-1;d=parseInt(date.substring(6,8),10);occurrence.formattedDate=format(new Date(y,m,d),conf.i18n.longDateFormat,conf)}}
result=$.tmpl('occurrenceTmpl',data);occurrenceDiv=element.find('.rioccurrences');occurrenceDiv.replaceWith(result);element.find('.rioccurrences .batching a').click(
function(event){event.preventDefault();loadOccurrences(startdate,rfc5545,this.attributes.start.value,readonly)});if(!readonly){element.find('.rioccurrences .action a.rrule').click(occurrenceExclude);element.find('.rioccurrences .action a.exdate').click(occurrenceInclude);element.find('.rioccurrences .action a.rdate').click(occurrenceDelete)}
element.find('.rioccurrences').show()},error: function(jqXHR,textStatus,errorThrown){alert(textStatus)}};$.ajax(dict)}
function getField(field){var realField=$(field);if(!realField.length){realField=$('#'+field)}
if(!realField.length){realField=$("input[name='"+field+"']")}
return realField}
function findStartDate(){var startdate=null;var startField,startFieldYear,startFieldMonth,startFieldDay;if(conf.startField){startField=getField(conf.startField);if(!startField.length){return null}
startdate=startField.data('dateinput');if(!startdate){startdate=startField.val();if(startdate===""){startdate=startField.text()}} else{startdate=startdate.getValue()}
if(typeof startdate==='string'){startdate=startdate.replace(' ','T')}
startdate=new Date(startdate)} else if(conf.startFieldYear&&conf.startFieldMonth&&conf.startFieldDay){startFieldYear=getField(conf.startFieldYear);startFieldMonth=getField(conf.startFieldMonth);startFieldDay=getField(conf.startFieldDay);if(!startFieldYear.length&&!startFieldMonth.length&&!startFieldDay.length){return null}
startdate=new Date(startFieldYear.val(),startFieldMonth.val()-1,startFieldDay.val())}
if(startdate===null){return null}
if(isNaN(startdate)){return null}
return startdate}
function findEndDate(form){var endField,enddate;endField=form.find('input[name=rirangebyenddatecalendar]');enddate=endField.data('dateinput');if(!enddate){enddate=endField.val()} else{enddate=enddate.getValue()}
enddate=new Date(enddate);if(isNaN(enddate)||endField.val()===""){return null}
return enddate}
function findIntField(fieldName,form){var field,num,isInt;field=form.find('input[name='+fieldName+']');num=field.val();if(isNaN(num)||(num.toString().indexOf('.')!==-1)||field.val()===""){return null}
return num}
function loadData(rfc5545){var selector,format,startdate,dayindex,day;if(rfc5545){widgetLoadFromRfc5545(form,conf,rfc5545,true)}
startdate=findStartDate();if(startdate!==null){form.find('select[name=rimonthlydayofmonthday]').val(startdate.getDate());dayindex=conf.orderIndexes[Math.floor((startdate.getDate()-1)/7)];day=conf.weekdays[startdate.getDay()];form.find('select[name=rimonthlyweekdayofmonthindex]').val(dayindex);form.find('select[name=rimonthlyweekdayofmonth]').val(day);form.find('select[name=riyearlydayofmonthmonth]').val(startdate.getMonth()+1);form.find('select[name=riyearlydayofmonthday]').val(startdate.getDate());form.find('select[name=riyearlyweekdayofmonthindex]').val(dayindex);form.find('select[name=riyearlyweekdayofmonthday]').val(day);form.find('select[name=riyearlyweekdayofmonthmonth]').val(startdate.getMonth()+1);loadOccurrences(startdate,widgetSaveToRfc5545(form,conf,false).result,0,false);form.find('div.rioccurrencesactions').show()} else{form.find('div.rioccurrencesactions').hide()}
selector=form.find('select[name=rirtemplate]');displayFields(selector)}
function recurrenceOn(){var RFC5545=widgetSaveToRfc5545(form,conf,false);var label=display.find('label[class=ridisplay]');label.text(conf.i18n.displayActivate+' '+RFC5545.description);textarea.val(RFC5545.result).change();var startdate=findStartDate();if(startdate!==null){loadOccurrences(startdate,widgetSaveToRfc5545(form,conf,false).result,0,true)}
display.find('a[name="riedit"]').text(conf.i18n.edit_rules);display.find('a[name="ridelete"]').show()}
function recurrenceOff(){var label=display.find('label[class=ridisplay]');label.text(conf.i18n.displayUnactivate);textarea.val('').change();display.find('.rioccurrences').hide();display.find('a[name="riedit"]').text(conf.i18n.add_rules);display.find('a[name="ridelete"]').hide()}
function checkFields(form){var startDate,endDate,num,messagearea;startDate=findStartDate();messagearea=form.find('#messagearea');messagearea.text('');messagearea.hide();form.find('.riaddoccurrence div.errorarea').text('').hide();if(form.find('#ridailyinterval').css('display')==='block'){num=findIntField('ridailyinterval',form);if(!num||num<1||num>1000){messagearea.text(conf.i18n.noRepeatEvery).show();return false}}
if(form.find('#riweeklyinterval').css('display')==='block'){num=findIntField('riweeklyinterval',form);if(!num||num<1||num>1000){messagearea.text(conf.i18n.noRepeatEvery).show();return false}}
if(form.find('#rimonthlyinterval').css('display')==='block'){num=findIntField('rimonthlyinterval',form);if(!num||num<1||num>1000){messagearea.text(conf.i18n.noRepeatEvery).show();return false}
if(form.find('#rimonthlyoptions input:checked').length===0){messagearea.text(conf.i18n.noRepeatOn).show();return false}}
if(form.find('#riyearlyinterval').css('display')==='block'){num=findIntField('riyearlyinterval',form);if(!num||num<1||num>1000){messagearea.text(conf.i18n.noRepeatEvery).show();return false}
if(form.find('#riyearlyoptions input:checked').length===0){messagearea.text(conf.i18n.noRepeatOn).show();return false}}
if(form.find('input[value="BYOCCURRENCES"]:visible:checked').length>0){num=findIntField('rirangebyoccurrencesvalue',form);if(!num||num<1||num>1000){messagearea.text(conf.i18n.noEndAfterNOccurrences).show();return false}}
if(form.find('input[value="BYENDDATE"]:visible:checked').length>0){endDate=findEndDate(form);if(!endDate){messagearea.text(conf.i18n.noEndDate).show();return false} else if(endDate<startDate){messagearea.text(conf.i18n.pastEndDate).show();return false}}
return true}
function save(event){event.preventDefault();if(checkFields(form)){form.overlay().close();recurrenceOn()}}
function cancel(event){event.preventDefault();form.overlay().close()}
function updateOccurances(){var startDate;startDate=findStartDate();if(checkFields(form)){loadOccurrences(startDate,widgetSaveToRfc5545(form,conf,false).result,0,false)}}
display=$.tmpl('displayTmpl',conf);form=$.tmpl('formTmpl',conf);form.overlay(conf.formOverlay).hide();form.ical={RDATE:[],EXDATE:[]};$.tools.dateinput.localize(conf.lang,{months:LABELS[conf.lang].months.join(),shortMonths:LABELS[conf.lang].shortMonths.join(),days:LABELS[conf.lang].weekdays.join(),shortDays:LABELS[conf.lang].shortWeekdays.join()});form.find('input[name=rirangebyenddatecalendar]').dateinput({selectors:true,lang:conf.lang,format:conf.i18n.shortDateFormat,firstDay:conf.firstDay,yearRange:[-5,10]}).data('dateinput').setValue(new Date());if(textarea.val()){var result=widgetLoadFromRfc5545(form,conf,textarea.val(),false);if(result===-1){var label=display.find('label[class=ridisplay]');label.text(conf.i18n.noRule)} else{recurrenceOn()}}
display.find('a[name=ridelete]').click(function(e){e.preventDefault();recurrenceOff()});display.find('a[name=riedit]').click(
function(e){loadData(textarea.val());e.preventDefault();form.overlay().load()});form.find('div.riaddoccurrence input#adddate').dateinput({selectors:true,lang:conf.lang,format:conf.i18n.shortDateFormat,firstDay:conf.firstDay,yearRange:[-5,10]}).data('dateinput').setValue(new Date());form.find('input#addaction').click(occurrenceAdd);form.find('a.rirefreshbutton').click(
function(event){event.preventDefault();updateOccurances()});form.find('select[name=rirtemplate]').change(
function(e){displayFields($(this))});form.find('select').change(
function(e){$(this).parent().find('> input').click().change()});form.find('input[name=rirangebyoccurrencesvalue]').change(
function(e){$(this).parent().find('input[name=rirangetype]').click().change()});form.find('input[name=rirangebyenddatecalendar]').change(function(){$(this).parent().find('input[name=rirangetype]').click();if(form.find('.rioccurrencesactions:visible').length!==0){updateOccurances()}});form.find('input:radio, .riweeklyweekday > input, input[name=ridailyinterval], input[name=riweeklyinterval], input[name=rimonthlyinterval], input[name=riyearlyinterval]').change(
function(e){if(form.find('.rioccurrencesactions:visible').length!==0){updateOccurances()}});form.find('.ricancelbutton').click(cancel);form.find('.risavebutton').click(save);$.extend(self,{display:display,form:form,loadData:loadData,save:save})}
$.fn.recurrenceinput=function(conf){if(this.data('recurrenceinput')){return this.data('recurrenceinput')}
var config=$.extend({},tool.conf);$.extend(config,conf);$.extend(config,{i18n:LABELS[config.lang],name:this.attr('name')});var recurrenceinput=new RecurrenceInput(config,this);recurrenceinput.form.appendTo('body');this.after(recurrenceinput.display);this.hide();this.data('recurrenceinput',recurrenceinput);return recurrenceinput}}(jQuery));

/* - ++resource++plone.app.event/event.js - */
// https://is.enes.org/portal_javascripts/++resource++plone.app.event/event.js?original=1
if(typeof(plone)==='undefined'){var plone={}}(function($,plone){plone.paevent=plone.paevent||{};plone.paevent.end_start_delta=1;plone.paevent.start_date=function(){return a_or_b($('#formfield-form-widgets-IEventBasic-start'),$('#archetypes-fieldname-startDate'))};plone.paevent.end_date=function(){return a_or_b($('#formfield-form-widgets-IEventBasic-end'),$('#archetypes-fieldname-endDate'))};
function initDelta(e){var start_datetime=getDateTime(plone.paevent.start_date());var end_datetime=getDateTime(plone.paevent.end_date());plone.paevent.end_start_delta=(end_datetime-start_datetime)/ 1000 / 3600;if(plone.paevent.end_start_delta<1){plone.paevent.end_start_delta=1}}
function getDateTime(datetimewidget){var fields=['year','month','day','hour','minute'];var parts={};$.each(fields, function(idx,fld){parts[fld]=parseInt($("[name$='-"+fld+"']",datetimewidget).val(),10)});var date=new Date(parts.year,parts.month-1,parts.day,parts.hour,parts.minute);return date}
function setDateTime(datetimewidget,new_date){$("[name$='-year']",datetimewidget).val(new_date.getYear());$("[name$='-month']",datetimewidget).val(new_date.getMonth());$("[name$='-day']",datetimewidget).val(new_date.getDate());$("[name$='-hour']",datetimewidget).val(new_date.getHours());$("[name$='-minute']",datetimewidget).val(new_date.getMinutes())}
function updateEndDate(){var start_date=getDateTime(plone.paevent.start_date());var new_end_date=start_date;new_end_date.setHours(new_end_date.getHours()+plone.paevent.end_start_delta);setDateTime(plone.paevent.end_date(),new_end_date);$("input[name$='-calendar']",plone.paevent.end_date()).data('dateinput').setValue(new_end_date)}
function validateEndDate(){var start_datetime=getDateTime(plone.paevent.start_date());var end_datetime=getDateTime(plone.paevent.end_date());if(end_datetime<start_datetime){plone.paevent.end_date().addClass("error")} else{plone.paevent.end_date().removeClass("error")}}
function show_hide_widget(widget,hide,fade){if(hide===true){if(fade===true){widget.fadeOut()}
else{widget.hide()}} else{if(fade===true){widget.fadeIn()}
else{widget.show()}}}
function a_or_b(a,b){var ret;if(a.length>0){ret=a} else{ret=b}
return ret}
function event_listing_calendar_init(cal){if($().dateinput&&cal.length>0){var get_req_param=function(name){if(name===(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search)){return decodeURIComponent(name[1])}};var val=get_req_param('date');if(val===undefined){val=new Date()} else{val=new Date(val)}
cal.dateinput({selectors:true,trigger:true,format:'yyyy-mm-dd',yearRange:[-10,10],firstDay:1,value:val,change: function(){var value=this.getValue("yyyy-mm-dd");window.location.href='event_listing?mode=day&date='+value}}).unbind('change').bind('onShow', function(event){var trigger_offset=$(this).next().offset();$(this).data('dateinput').getCalendar().offset({top:trigger_offset.top+20,left:trigger_offset.left})})}}
$(function(){var jq_whole_day=a_or_b($('#formfield-form-widgets-IEventBasic-whole_day input'),$('form[name="edit_form"] input#wholeDay'));var jq_datetime=a_or_b($('#form-widgets-IEventBasic-start-timecomponents, #form-widgets-IEventBasic-end-timecomponents'),$('#archetypes-fieldname-startDate .datetimewidget-time, #archetypes-fieldname-endDate .datetimewidget-time'));if(jq_whole_day.length>0){jq_whole_day.bind('change', function(e){show_hide_widget(jq_datetime,e.target.checked,true)});show_hide_widget(jq_datetime,jq_whole_day.get(0).checked,false)}
var jq_open_end=a_or_b($('#formfield-form-widgets-IEventBasic-open_end input'),$('form[name="edit_form"] input#openEnd'));var jq_end=plone.paevent.end_date();if(jq_open_end.length>0){jq_open_end.bind('change', function(e){show_hide_widget(jq_end,e.target.checked,true)});show_hide_widget(jq_end,jq_open_end.get(0).checked,false)}
var jq_start=plone.paevent.start_date();$("select",jq_start).on("change",updateEndDate);$("input[name$='-calendar']",jq_start).on("onHide",updateEndDate);$("select",jq_end).on("change", function(){initDelta();validateEndDate()});$("input[name$='-calendar']",jq_end).on("onHide", function(){initDelta();validateEndDate()});event_listing_calendar_init($("#event_listing_calendar"))})}(jQuery,plone));

/* - ++resource++plone.app.event.portlet_calendar.js - */
// https://is.enes.org/portal_javascripts/++resource++plone.app.event.portlet_calendar.js?original=1
(function($){
function load_portlet_calendar(event,elem){event.preventDefault();var pw=elem.closest('.portletWrapper');var elem_data=elem.data();var portlethash=pw.attr('id');portlethash=portlethash.substring(15,portlethash.length);url=portal_url+'/@@render-portlet?portlethash='+portlethash+'&year='+elem_data.year+'&month='+elem_data.month;$.ajax({url:url,success: function(data){pw.html(data);rebind_portlet_calendar()}})}
function rebind_portlet_calendar(){$('.portletCalendar a.calendarNext').click(function(event){load_portlet_calendar(event,$(this))});$('.portletCalendar a.calendarPrevious').click(function(event){load_portlet_calendar(event,$(this))});$('.portletCalendar dd a[title]').tooltip({offset:[-10,0],tipClass:'pae_calendar_tooltip'})}
$(document).ready(function(){rebind_portlet_calendar()})}(jQuery));
